<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns:st1="urn:schemas-microsoft-com:office:smarttags"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=gb2312">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 11">
<meta name=Originator content="Microsoft Word 11">
<link rel=File-List href="yacc.files/filelist.xml">
<link rel=Edit-Time-Data href="yacc.files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>Yacc: Yet Another Compiler-Compiler</title>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="PostalCode"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="State"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="City"/>
<o:SmartTagType namespaceuri="urn:schemas-microsoft-com:office:smarttags"
 name="place"/>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>梁英毅</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>梁英毅</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>1</o:TotalTime>
  <o:Created>2006-03-12T21:39:00Z</o:Created>
  <o:LastSaved>2006-03-12T21:40:00Z</o:LastSaved>
  <o:Pages>1</o:Pages>
  <o:Words>6191</o:Words>
  <o:Characters>35294</o:Characters>
  <o:Company>清华大学计算机科学与技术系软件所</o:Company>
  <o:Lines>294</o:Lines>
  <o:Paragraphs>82</o:Paragraphs>
  <o:CharactersWithSpaces>41403</o:CharactersWithSpaces>
  <o:Version>11.5606</o:Version>
 </o:DocumentProperties>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:WordDocument>
  <w:ValidateAgainstSchemas/>
  <w:SaveIfXMLInvalid>false</w:SaveIfXMLInvalid>
  <w:IgnoreMixedContent>false</w:IgnoreMixedContent>
  <w:AlwaysShowPlaceholderText>false</w:AlwaysShowPlaceholderText>
  <w:Compatibility>
   <w:UseFELayout/>
  </w:Compatibility>
  <w:BrowserLevel>MicrosoftInternetExplorer4</w:BrowserLevel>
 </w:WordDocument>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <w:LatentStyles DefLockedState="false" LatentStyleCount="156">
 </w:LatentStyles>
</xml><![endif]--><!--[if !mso]><object
 classid="clsid:38481807-CA0E-42D2-BF39-B33AF135CC4D" id=ieooui></object>
<style>
st1\:*{behavior:url(#ieooui) }
</style>
<![endif]-->
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
@font-face
	{font-family:宋体;
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-alt:SimSun;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
@font-face
	{font-family:"\@宋体";
	panose-1:2 1 6 0 3 1 1 1 1 1;
	mso-font-charset:134;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:3 135135232 16 0 262145 0;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
h1
	{mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	mso-outline-level:1;
	font-size:24.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;
	font-weight:bold;}
p
	{mso-margin-top-alt:auto;
	margin-right:0cm;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
pre
	{margin-top:0cm;
	margin-bottom:0cm;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:宋体;
	mso-bidi-font-family:宋体;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:42.55pt;
	mso-footer-margin:49.6pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
 @list l0
	{mso-list-id:505024642;
	mso-list-template-ids:-530562356;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:36.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l0:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:72.0pt;
	mso-level-number-position:left;
	text-indent:-18.0pt;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 10]>
<style>
 /* Style Definitions */
 table.MsoNormalTable
	{mso-style-name:普通表格;
	mso-tstyle-rowband-size:0;
	mso-tstyle-colband-size:0;
	mso-style-noshow:yes;
	mso-style-parent:"";
	mso-padding-alt:0cm 5.4pt 0cm 5.4pt;
	mso-para-margin:0cm;
	mso-para-margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	mso-ansi-language:#0400;
	mso-fareast-language:#0400;
	mso-bidi-language:#0400;}
</style>
<![endif]--><!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body bgcolor=white lang=ZH-CN link=blue vlink=blue style='tab-interval:21.0pt'>

<div class=Section1>

<h1 align=center style='text-align:center'><span lang=EN-US>Yacc: </span>另一个编译器的编译器
</h1>

<p align=center style='text-align:center'><st1:place w:st="on"><st1:City w:st="on"><i><span
  lang=EN-US>Stephen C. Johnson</span></i><span lang=EN-US><br>
  Bell Laboratories<br>
  Murray Hill</span></st1:City><span lang=EN-US>, <st1:State w:st="on">New
  Jersey</st1:State> <st1:PostalCode w:st="on">07974</st1:PostalCode></span></st1:place><span
lang=EN-US> </span></p>

<p align=center style='text-align:center'>翻译：<span lang=EN-US><a
href="http://mhss.nease.net/"><span lang=EN-US><span lang=EN-US>寒蝉退士</span></span></a></span></p>

<blockquote style='margin-top:5.0pt;margin-bottom:5.0pt'>

<p><b><span style='font-size:10.0pt'>译者声明</span></b><span style='font-size:
10.0pt'>：<span lang=EN-US><br>
</span>译者对译文不做任何担保，译者对译文不拥有任何权利并且不负担任何责任和义务。<b><span lang=EN-US><br>
</span>原文：</b><span lang=EN-US>http://cm.bell-labs.com/7thEdMan/vol2/yacc.bun</span></span></p>

<h2>摘要 </h2>

<p>计算机程序的输入通常有某种结构；实际上，可以认为每个需要输入的计算机程序都定义了一门它所接受的<span lang=EN-US>“</span>输入语言<span
lang=EN-US>”</span>。输入语言可以像编程语言那么复杂，或者像一序列的数那么简单。不幸的是，通常的输入设施是有限的、难于使用的，并经常疏于检查它们的输入的有效性。</p>

<p><span lang=EN-US>Yacc </span>提供了一个通用工具来描述计算机程序的输入。<span lang=EN-US>Yacc </span>用户规定它的输入的结构，连同在识别每个这种结构的时候调用的代码。<span
lang=EN-US>Yacc </span>把这样的规定转换成操作输入处理的一个子例程；用这个子例程处理用户应用中的多数控制流经常是方便和适当的。</p>

<p><span lang=EN-US>Yacc </span>生成的输入子例程调用用户提供的一个例程来返回下一个基本输入项目<span
lang=EN-US>(item)</span>。所以，用户可以以单个的输入字符的方式，或以更高层构造如名字和数的方式 来规定它的输入。通过用户提供的例程还可以处理惯用的特征如注释和<span
lang=EN-US>(</span>行<span lang=EN-US>)</span>接续约定，这些东西典型的违反容易的文法规定。</p>

<p><span lang=EN-US>Yacc </span>是用可移植的<span lang=EN-US> C </span>语言写成的。接受的规定类别是非常一般性的<span
lang=EN-US>: </span>带有去歧义规则的<span lang=EN-US> LALR(1) </span>文法。</p>

<p>除了用于<span lang=EN-US> C</span>、<span lang=EN-US>APL</span>、<span lang=EN-US>Pascal</span>、<span
lang=EN-US>RATFOR </span>等编译器之外，<span lang=EN-US>Yacc </span>还用于非常规语言，包括一个照相排版机语言、一些桌面计算器语言、一个文档检索系统、和一个<span
lang=EN-US> Fortran </span>调试系统。 </p>

</blockquote>

<p><span lang=EN-US>July 31,1978</span></p>

<div class=MsoNormal align=center style='text-align:center'><span lang=EN-US>

<hr size=2 width="100%" align=center>

</span></div>

<h2>目录</h2>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#0">0: <span lang=EN-US><span lang=EN-US>介绍</span></span></a></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#1">1: <span lang=EN-US><span lang=EN-US>基本规定</span></span></a></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#2">2: <span lang=EN-US><span lang=EN-US>动作</span></span></a></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#3">3: <span lang=EN-US><span lang=EN-US>词法分析</span></span></a></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#4">4: <span lang=EN-US><span lang=EN-US>解析器如何工作</span></span></a></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#5">5: <span lang=EN-US><span lang=EN-US>歧义和冲突</span></span></a></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#6">6: <span lang=EN-US><span lang=EN-US>优先级</span></span></a></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#7">7: <span lang=EN-US><span lang=EN-US>错误处理</span></span></a></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#8">8: Yacc <span lang=EN-US><span lang=EN-US>环境</span></span></a></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#9">9: <span lang=EN-US><span lang=EN-US>对准备规定的提示</span></span></a> </span></li>
 <ul type=circle>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;mso-list:l0 level2 lfo1;tab-stops:list 72.0pt'><span lang=EN-US><a
      href="#9.1"><span lang=EN-US><span lang=EN-US>输入样式</span></span></a></span></li>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;mso-list:l0 level2 lfo1;tab-stops:list 72.0pt'><span lang=EN-US><a
      href="#9.2"><span lang=EN-US><span lang=EN-US>左递归</span></span></a></span></li>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;mso-list:l0 level2 lfo1;tab-stops:list 72.0pt'><span lang=EN-US><a
      href="#9.3"><span lang=EN-US><span lang=EN-US>词法搭配</span></span></a></span></li>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;mso-list:l0 level2 lfo1;tab-stops:list 72.0pt'><span lang=EN-US><a
      href="#9.4"><span lang=EN-US><span lang=EN-US>保留字</span></span></a></span></li>
 </ul>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#10">10: <span lang=EN-US><span lang=EN-US>高级主题</span></span></a> </span></li>
 <ul type=circle>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;mso-list:l0 level2 lfo1;tab-stops:list 72.0pt'><span lang=EN-US><a
      href="#10.1"><span lang=EN-US><span lang=EN-US>在动作中模拟错误和接受</span></span></a></span></li>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;mso-list:l0 level2 lfo1;tab-stops:list 72.0pt'><span lang=EN-US><a
      href="#10.2"><span lang=EN-US><span lang=EN-US>访问外围规则中的值</span></span></a></span></li>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;mso-list:l0 level2 lfo1;tab-stops:list 72.0pt'><span lang=EN-US><a
      href="#10.3"><span lang=EN-US><span lang=EN-US>支持任意的值类型</span></span></a></span></li>
 </ul>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#11">11: <span lang=EN-US><span lang=EN-US>致谢</span></span></a></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#r"><span lang=EN-US><span lang=EN-US>引用</span></span></a></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#a"><span lang=EN-US><span lang=EN-US>附录 A: </span></span><span
     lang=EN-US><span lang=EN-US>简单的例子</span></span></a></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#b"><span lang=EN-US><span lang=EN-US>附录 B: Yacc </span></span><span
     lang=EN-US><span lang=EN-US>输入语法</span></span></a></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#c"><span lang=EN-US><span lang=EN-US>附录 C: </span></span><span
     lang=EN-US><span lang=EN-US>高级的例子</span></span></a></span></li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l0 level1 lfo1;tab-stops:list 36.0pt'><span lang=EN-US><a
     href="#d"><span lang=EN-US><span lang=EN-US>附录 D: </span></span><span
     lang=EN-US><span lang=EN-US>支持但不鼓励的旧特征</span></span></a></span></li>
</ul>

<div class=MsoNormal align=center style='text-align:center'><span lang=EN-US>

<hr size=2 width="100%" align=center>

</span></div>

<h2><a name=0><span lang=EN-US>0: </span>介绍</a> </h2>

<p class=MsoNormal><span lang=EN-US>Yacc </span>提供了一个通用工具来在计算机程序的输入上施加结构。<span
lang=EN-US>Yacc </span>用户准备输入处理的规定；它包括描述输入结构的规则，在识别了这些规则的时候调用的代码，和做基本输入的一个低层例程。<span
lang=EN-US>Yacc </span>接着生成一个函数来控制输入处理。这个函数叫做解析器<span lang=EN-US>(parser)</span>，它调用用户提供的低层输入例程<span
lang=EN-US>(</span>词法分析器<span lang=EN-US>(analyzer))</span>来从输入流中选 取基本项目<span
lang=EN-US>(</span>叫做记号<span lang=EN-US>(token))</span>。依据叫做文法规则的输入结构规则来组织这些记号；在识别了这些规则中的某一个的时候，接着调用为这个规则提供的叫
做动作的用户代码；动作有能力返回值并使用其他动作的值。 </p>

<p><span lang=EN-US>Yacc </span>是用<span lang=EN-US> C[1] </span>语言的一个可移植方言写成的，并且动作和输出的例程也一样使用<span
lang=EN-US> C </span>语言。此外，<span lang=EN-US>Yacc </span>的很多语法约定依从<span
lang=EN-US> C </span>语言。</p>

<p>输入规定的心脏是一组文法规则。每个规则描述一个允许的结构并给它一个名字。例如，下面的文法规则 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>date<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp; </span>month_name<span style='mso-spacerun:yes'>&nbsp; </span>day<span style='mso-spacerun:yes'>&nbsp; </span>','<span style='mso-spacerun:yes'>&nbsp; </span>year<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>;</span></pre>

<p class=MsoNormal>这里的<span lang=EN-US> date</span>、<span lang=EN-US>month_name</span>、<span
lang=EN-US>day</span>、和<span lang=EN-US> year </span>表示在输入处理中它感兴趣的那些结构；<span
lang=EN-US>month_name</span>、<span lang=EN-US>day </span>和<span lang=EN-US>
year </span>大概是在其他地方定义的。逗号<span lang=EN-US>“,”</span>包围在单引号之中；这暗示了逗号在输入中是作为文字<span
lang=EN-US>(literal)</span>出现的。冒号和分号只是充当规则中的标点符号，而对控制输入没有意义。所以，有着正确定义的输入 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>July<span style='mso-spacerun:yes'>&nbsp; </span>4, 1776</span></pre>

<p class=MsoNormal>可以匹配上述规则。</p>

<p>输入处理的一个重要部分是完成词法分析器。这个用户例程读取输入流，识别低层结构，并把这些记号传达到解析器。出于历史原因，词法分析器识别的结构叫做终结符<span
lang=EN-US>(terminal symbol)</span>，而解析器识别的结构叫做非终结符<span lang=EN-US>(nonterminal
symbol)</span>。为了避免混淆，终结符通常会称呼为记号。</p>

<p>在使用词法分析器还是使用文法解析器之间有相当可观的回旋余地。例如，规则 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>month_name<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp; </span>'J' 'a' 'n'<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>month_name<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp; </span>'F' 'e' 'b'<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>. . .</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>month_name<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp; </span>'D' 'e' 'c'<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>;</span></pre>

<p class=MsoNormal>可以用于上述例子。这个文法解析器只需要识别单个字母，而<span lang=EN-US> month_name </span>将是一个非终结符。这种低层规则趋向于浪费时间和空间，并可能使规则复杂得超越了<span
lang=EN-US> Yacc </span>的处理能力。通常的，词法分析器将识别月份名字，并返回见到了<span lang=EN-US>
month_name </span>的一个指示；在这种情况下，<span lang=EN-US>month_name </span>将是一个记号。</p>

<p>文字字符比如<span lang=EN-US>“,”</span>也必须通过词法分析器来传递，所以也被当作记号。</p>

<p>规定文件是非常灵活的。向上述例子增加规则是相对容易的 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>date<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp; </span>month '/' day '/' year<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>;</span></pre>

<p class=MsoNormal>允许 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>7 / 4 / 1776</span></pre>

<p class=MsoNormal>作为 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>July 4, 1776</span></pre>

<p class=MsoNormal>的同义字。在多数情况下，这个新规则可以<span lang=EN-US>“</span>滑入<span
lang=EN-US>”</span>到工作系统中，并带有最小的努力，和混乱现存输入的很小的危险性。</p>

<p>读取中的输入可能无 法满足这个规定。检测到这些错误可以同从左至右扫描理论上能做到的一样早；所以，不只是充分的减少了读取并计算不良数据的可能性，而且通常可以快速的发现
不良数据。作为输入规定的一部分提供的错误处理，允许不良数据的再入，或在跳过不良数据之后继续做输入处理。</p>

<p>在一些情况下，<span lang=EN-US>Yacc </span>在给出某一组规定的时候无法生成解析器。例如，规定可能自相矛盾，或者它们要求比<span
lang=EN-US> Yacc </span>提供的更强力的识别机制。前者情况表示设计错误；后者情况经常可以通过使词法分析器更强力，或重写某些文法规则来修正。尽管<span
lang=EN-US> Yacc </span>不能处理所有可能的规定，它的能力可以顺利的同类似系统相比较；此外，<span lang=EN-US>Yacc </span>难于处理的构造经常也是难于人类处理的。一些用户报告对他们的输入明确表述有效的<span
lang=EN-US> Yacc </span>规定，暴露了程序开发中早期的概念或设计错误。</p>

<p><span lang=EN-US>Yacc </span>底层的理论已经在其他地方<span lang=EN-US>[2, 3, 4]</span>描述了。<span
lang=EN-US>Yacc </span>已经在大量的实际应用中广泛的使用了，包括<span lang=EN-US> lint[5]</span>、可移植<span
lang=EN-US> C </span>编译器<span lang=EN-US>[6]</span>、和一个排版数学的系统<span lang=EN-US>[7]</span>。</p>

<p>下面的章节描述准备<span lang=EN-US> Yacc </span>规定的基本过程；第<span lang=EN-US> 1 </span>节描述准备文法规则，第<span
lang=EN-US> 2 </span>节描述准备与这些规则相关联的用户提供的动作，而第<span lang=EN-US> 3 </span>节准备词法分析器。第<span
lang=EN-US> 4 </span>节描述解析器的操作。第<span lang=EN-US> 5 </span>节讨论<span lang=EN-US>
Yacc </span>有可能无法从规定生成解析器的各种原因和对此要做些什么。第<span lang=EN-US> 6 </span>节描述处理在算术表达式中操作符<span
lang=EN-US>(operator)</span>优先级<span lang=EN-US>(precedence)</span>的简单机制。第<span
lang=EN-US> 7 </span>节讨论错误检测和修复。第<span lang=EN-US> 8 </span>节讨论<span
lang=EN-US> Yacc </span>生成的解析器的操作环境和特殊特征。第<span lang=EN-US> 9 </span>节给出增进规定的样式和效率的一些建议。第<span
lang=EN-US> 10 </span>节讨论一些高级主题，而第<span lang=EN-US> 11 </span>节给出致谢。附录<span
lang=EN-US> A </span>有一个简单的例子，而附录<span lang=EN-US> B </span>给出<span lang=EN-US>
Yacc </span>输入语法的总结。附录<span lang=EN-US> C </span>给出使用<span lang=EN-US> Yacc </span>的某些高级特征的一个例子，最后，附录<span
lang=EN-US> D </span>描述出于同<span lang=EN-US> Yacc </span>老版本的历史延续性而提供的不再活跃支持的机制和语法。
</p>

<h2><a name=1><span lang=EN-US>1: </span>基本规定</a> </h2>

<p>名字称谓的是记号或非终结符二者之一。<span lang=EN-US>Yacc </span>同样的要求声明记号名字。此外，出于在第<span
lang=EN-US> 3 </span>节中讨论的原因，经常需要把词法分析器包括为规定文件的一部分；同样也可以包括其他有用的程序。所以，每个规定文件都由三段组成<span
lang=EN-US>: </span>声明、<span lang=EN-US>(</span>文法<span lang=EN-US>)</span>规则和程序。使用双重百分号<span
lang=EN-US>“%%” </span>来分隔各段。<span lang=EN-US>(</span>百分号<span lang=EN-US>“%”</span>在<span
lang=EN-US> Yacc </span>规定中一般用做转义<span lang=EN-US>(escape)</span>字符。<span
lang=EN-US>)</span></p>

<p>换句话说，完整的规定文件看起来如下 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>声明</pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%%</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>规则</pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%%</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>程序</pre>

<p class=MsoNormal>声明段可以为空。此外，如果省略了程序段，第二个<span lang=EN-US> %% </span>号也可以省略；</p>

<p>所以，最小的合法<span lang=EN-US> Yacc </span>规定是 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%%</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></span>规则</pre>

<p>除了不能出现在名字或多字符保留符号中之外，空白、<span lang=EN-US>tab </span>和换行被忽略。注释可以出现在名字是合法的任何地方；它们被包围在<span
lang=EN-US> /* . . . */ </span>中，同<span lang=EN-US> C </span>和<span lang=EN-US>
PL/I </span>语言一样。</p>

<p>规则段由一个或多个文法规则构成。文法规则有如下格式<span lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp; </span>BODY<span style='mso-spacerun:yes'>&nbsp; </span>;</span></pre>

<p class=MsoNormal><span lang=EN-US>A </span>表示一个非终结符名字，而<span lang=EN-US> BODY
</span>代表一序列的零个或更多的名字和文字。冒号和分号是<span lang=EN-US> Yacc </span>标点符号。</p>

<p>名字可以有任意长度，并由字母、点<span lang=EN-US>“.”</span>、下划线<span lang=EN-US>“_”</span>和不开头的数字组成。区分大写和小写字母。在文法规则主体中使用的名字可以代表记号或非终结符。</p>

<p>文字由包围在单引号<span lang=EN-US>“'”</span>中的字符组成。同<span lang=EN-US> C </span>语言一样，反斜杠<span
lang=EN-US>“\”</span>在文字中是转义字符，并识别所有<span lang=EN-US> C </span>转义。所以</p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'\n'<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span>换行</pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'\r'<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span>回车</pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'\''<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span>单引号<span
lang=EN-US> ``'''</span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'\\'<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span></span>反斜杠<span
lang=EN-US> ``\''</span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'\t'<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>tab</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'\b'<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>backspace</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'\f'<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>form feed</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'\xxx'<span style='mso-spacerun:yes'>&nbsp; </span>``xxx'' </span>八进制数</pre>

<p class=MsoNormal>出于一些技术原因，<span lang=EN-US>NUL </span>字符<span lang=EN-US>('\0'
</span>或<span lang=EN-US> 0)</span>在文法规则中不应该使用。</p>

<p>如果有一些文法规则有相同的左手端，可以使用竖杠<span lang=EN-US>“|”</span>来避免重写左手端。此外，在规则末端的分号如果在竖杠之前则可以去掉。所以给<span
lang=EN-US> Yacc </span>的文法规则 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>B<span style='mso-spacerun:yes'>&nbsp; </span>C<span style='mso-spacerun:yes'>&nbsp; </span>D<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>E<span style='mso-spacerun:yes'>&nbsp; </span>F<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>G<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>;</span></pre>

<p class=MsoNormal>可以写为 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>B<span style='mso-spacerun:yes'>&nbsp; </span>C<span style='mso-spacerun:yes'>&nbsp; </span>D</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>E<span style='mso-spacerun:yes'>&nbsp; </span>F</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>G</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<p class=MsoNormal>在文法规则段中有相同左手端的所有文法规则出现在一起不是必须的，但是这使输入更加可读并易于改变。</p>

<p>如果一个非终结符匹配空字符串，则可以用明显的方式来指示<span lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>empty :<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>;</span></pre>

<p>代表记号的名字必须被声明；最简单的就是在声明段中写 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%token<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>name1<span style='mso-spacerun:yes'>&nbsp; </span>name2 . . .</span></pre>

<p class=MsoNormal>。<span lang=EN-US>(</span>更多的讨论参见章节<span lang=EN-US> 3</span>、<span
lang=EN-US>5 </span>和<span lang=EN-US> 6)</span>。假定没有在声明段中定义的每个名字都是非终结符。每个非终结符都必须至少在一个规则的左手端出现。</p>

<p>在所有非终结符中，有一个叫做开始符号的特别重要。解析器就是设计用来识别这个开始符号；所以这个符号代表文法规则描述的最大的最一般的结构。缺省的，在规则段中使用这个开始符号作为第一个文法规则。在声明段中使用<span
lang=EN-US> %start </span>关键字显式的声明这个开始字符是可能的，并在实际上是需要的<span lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%start<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>symbol</span></pre>

<p>通过叫做结束标记<span lang=EN-US>(endmarker)</span>的特殊记号向解析器通知输入结束。如果直到但不包括这个结束标记的记号形成了同开始符号相匹配的一个结构，则解析器函数在见到结束标记之后返回到它的调用者。如果在任何其他上下文中见到这个结束标记，都是一个错误。</p>

<p>在适当的时候返回结束标记是用户提供的词法分析器的工作；参见下面的第<span lang=EN-US> 3 </span>节。通常结束标记代表某种相当明显的<span
lang=EN-US> I/O </span>状态，比如<span lang=EN-US>“</span>文件结束<span lang=EN-US>”</span>或<span
lang=EN-US>“</span>记录结束<span lang=EN-US>”</span>。 </p>

<h2><a name=2><span lang=EN-US>2: </span>动作</a> </h2>

<p>对于每个文法规则，用户都可以关联上在输入处理中每次识别了这个规则的时候进行的动作。这些动作可以返回值，并可以获得从前面动作返回的值。此外，词法分析器可以返回记号的值，如果需要的话。</p>

<p>动作是任意的<span lang=EN-US> C </span>语句，同样可以做输入输出，调用子程序，和更改外部向量和变量。动作被指定为包围在花括号<span
lang=EN-US>“{”</span>和<span lang=EN-US>“}”</span>中的一个或多个语句。例如， </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'('<span style='mso-spacerun:yes'>&nbsp; </span>B<span style='mso-spacerun:yes'>&nbsp; </span>')'</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>hello( 1, &quot;abc&quot; );<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre>

<p class=MsoNormal>和 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>XXX<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>YYY<span style='mso-spacerun:yes'>&nbsp; </span>ZZZ</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>printf(&quot;a message\n&quot;);</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>flag = 25;<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>}</span></pre>

<p class=MsoNormal>是带有动作的文法规则。</p>

<p>为了便利在动作和解析器之间的通信，对动作语句要做稍微的改动。在这个上下文中使用美元符号<span lang=EN-US>“$”</span>作为给<span
lang=EN-US> Yacc </span>的一个信号。</p>

<p>要返回值，动作通常把伪变量<span lang=EN-US>(pseudo-variable)“$$”</span>设置为某个值。例如，不做任何事但返回值<span
lang=EN-US> 1 </span>的动作是 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp; </span>$$ = 1;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre>

<p>要获得前面动作和词法分析器的返回值，动作必须使用伪变量<span lang=EN-US> $1</span>、<span lang=EN-US>$2</span>、<span
lang=EN-US>. . .</span>，它们提及的是规则右手端的部件<span lang=EN-US>(component)</span>的返回值，它们是从左至右读取的。所以，如果规则是
</p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>B<span style='mso-spacerun:yes'>&nbsp; </span>C<span style='mso-spacerun:yes'>&nbsp; </span>D<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>;</span></pre>

<p class=MsoNormal>例如，这里的<span lang=EN-US> $2 </span>拥有<span lang=EN-US> C </span>返回的值，而<span
lang=EN-US> $3 </span>是<span lang=EN-US> D </span>返回的值。</p>

<p>作为一个更具体的例子，考虑规则 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'('<span style='mso-spacerun:yes'>&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>')'<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>;</span></pre>

<p class=MsoNormal>这个规则返回的值通常是圆括号中的<span lang=EN-US> expr </span>的值。这可以指示为 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'('<span style='mso-spacerun:yes'>&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>')'<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp; </span>$$ = $2 ;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre>

<p>缺省的，规则的值是其中第一个元素<span lang=EN-US>($1)</span>的值。所以，如下形式的文法规则 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>B<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<p class=MsoNormal>经常不需要显式的动作。</p>

<p>在上述例子中，所有动作都在规则的末端。有时，需要在一个规则被完全解析之前获得控制权。<span lang=EN-US>Yacc </span>允许在规则中间同末端一样写动作。假定这个动作<span
lang=EN-US>(</span><span style='font-size:10.0pt'>原文误作</span>规则<span
lang=EN-US>)</span>返回一个值，它右面的动作可以通过平常的机制访问它。依次的，它可以访问它左面动作的返回值。所以，规则 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>B</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp; </span>$$ = 1;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>C</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>x = $2;<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>y = $3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<p class=MsoNormal>在效果上是设置<span lang=EN-US> x </span>为<span lang=EN-US> 1</span>，设置<span
lang=EN-US> y </span>为<span lang=EN-US> C </span>返回的值。</p>

<p><span lang=EN-US>Yacc </span>通过制造一个新的非终结符名字，和把这个名字匹配到空字符串的一个新规则，来处理不终结一个规则的动作。内部动作是通过识别这个增加的规则而触发的动作。<span
lang=EN-US>Yacc </span>实际上对待上述例子如同它被写为<span lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$ACT<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/* empty */</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp; </span>$$ = 1;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>B<span style='mso-spacerun:yes'>&nbsp; </span>$ACT<span style='mso-spacerun:yes'>&nbsp; </span>C</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>x = $2;<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>y = $3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<p>在很多应用中，动作不做直接的输出；转而在内存中构造一个一个数据结构，比如解析树，并在生成输出之前向它应用变换。给出建造并维护想要的树结构的例程，分析树就特别易于构造。例如，假定写了一个<span
lang=EN-US> C </span>函数<span lang=EN-US> node</span>，调用 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>node( L, n1, n2 )</span></pre>

<p class=MsoNormal>建立带有标签<span lang=EN-US> L </span>和后代节点的<span lang=EN-US> n1 </span>和<span
lang=EN-US> n2 </span>的一个节点，并返回这个新建节点的索引。在规定中可以通过提供如下动作来构造析树<span lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'+'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp; </span>$$ = node( '+', $1, $3 );<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre>

<p>用户可以定义动作使用的其他变量。这种声明和定义可以出现在声明段中，包围在标号<span lang=EN-US>“%{”</span>和<span
lang=EN-US>“%}”</span>之间。这些声明和定义有全局作用域，所以它们可以被动作语句和词法分析器所知晓。例如， </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%{<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>int variable = 0;<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>%}</span></pre>

<p class=MsoNormal>可以放置到声明段中，使<span lang=EN-US> variable </span>对于所有动作都是可以访问的。<span
lang=EN-US>Yacc </span>解析器只使用以<span lang=EN-US>“yy”</span>开始的名字；用户应当避免使用这种名字。</p>

<p>在这些例子中，所有变量都是整数<span lang=EN-US>: </span>对其他类型的值的讨论可以在章节<span lang=EN-US> 10
</span>中找到。 </p>

<h2><a name=3><span lang=EN-US>3: </span>词法分析</a> </h2>

<p>用户必须提供一个词法分析器来读取输入流并把记号<span lang=EN-US>(</span>带有值，如果需要的话<span lang=EN-US>)</span>传达到解析器。词法分析器使叫做<span
lang=EN-US> yylex </span>的整数值的函数。 这个函数返回一个整数的记号编号，它表示读取的记号的种类。如果这个记号关联着一个值，应当把它赋予外部变量<span
lang=EN-US> yylval</span>。</p>

<p>为使通信得以发生，解析器和词法分析器必须在记号编号上达成一致。编号可以由<span lang=EN-US> Yacc </span>或用户来选择。在这两种情况下，使用<span
lang=EN-US> C </span>语言的<span lang=EN-US>“# define”</span>机制允许词法分析器使用符号来返回这些编号。例如，假定在<span
lang=EN-US> Yacc </span>规定文件的声明段中已经定义记号名字<span lang=EN-US> DIGIT</span>。词法分析器的相关部分可能看起来如下<span
lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>yylex(){</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>extern int yylval;</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>int c;</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>. . .</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>c = getchar();</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>. . .</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>switch( c ) {</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>. . .</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>case '0':</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>case '1':</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>. . .</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>case '9':</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>yylval = c-'0';</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return( DIGIT );</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>. . .</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>. . .</span></pre>

<p>它的意图是返回一个<span lang=EN-US> DIGIT </span>记号编号，和等于这个数字的数值的一个值。倘若词法分析器代码位于规定文件的程序段，标识符<span
lang=EN-US> DIGIT </span>将被定义为与记号<span lang=EN-US> DIGIT </span>关联的记号编号。</p>

<p>这种机制导致清晰的、易于修改的词法分析器；唯一的缺点是在文法中需要避免使用任何在<span lang=EN-US> C </span>语言或解析器中保留的或有意义的记号名字；例如，使用记号名字<span
lang=EN-US> if </span>或<span lang=EN-US> while </span>就一定会导致编译词法分析器时出现严峻的困难。记号名字<span
lang=EN-US> error </span>保留给错误处理，不应该随便使用<span lang=EN-US>(</span>参见章节<span
lang=EN-US> 7)</span>。</p>

<p>同上所述，记号编号可以由<span lang=EN-US> Yacc </span>或用户来选择。在缺省的条件下，编号由<span
lang=EN-US> Yacc </span>选择。文字字符的缺省记号编号是它在本地字符集中的字符数值。其他名字赋予从<span lang=EN-US>
257 </span>开始的记号编号。</p>

<p>要把一个记号编号赋予一个记号<span lang=EN-US>(</span>包括文字<span lang=EN-US>)</span>，可以在声明段中记号或文字的第一次出现时直接跟随着一个非负整数。这个整数被接受为这个名字或文字的记号编号。不通过这种机制定义的名字和文字保持它们的缺省定义。所有记号编号都是不同的是很重要的。</p>

<p>出于历史原因，结束标记必须有记号编号<span lang=EN-US> 0 </span>或负数。这个记号编号不能由用户重定义；所以，所有词法分析器在到达它们的输入结束处的时候应当准备返回<span
lang=EN-US> 0 </span>或负数作为记号编号。 </p>

<p>构造词法分析器的一个有用的工具是<span lang=EN-US> Mike Lesk[8]</span>开发的<span lang=EN-US>
Lex </span>程序。这些词法分析器设计用来与<span lang=EN-US> Yacc </span>解析器紧密协调工作。这些词法分析器的规定使用正则表达式而不是文法规则。可以轻易的用<span
lang=EN-US> Lex </span>生成非常复杂的词法分析器，但是仍有一些语言<span lang=EN-US>(</span>比如<span
lang=EN-US> FORTRAN)</span>不适应任何理论框架，它的词法分析器必须手工制作。 </p>

<h2><a name=4><span lang=EN-US>4: </span>解析器如何工作</a> </h2>

<p><span lang=EN-US>Yacc </span>把规定文件转换成<span lang=EN-US> C </span>程序，它依据给出的规定解析输入。做从规定到解析器转换的算法是复杂的，就不在这里讨论了<span
lang=EN-US>(</span>更多信息参见引用<span lang=EN-US>)</span>。但是，解析器自身就相对简单了，理解它是如何工作的，尽管不是严格必须的，但会使错误修复和歧义处置更加易于理解。</p>

<p><span lang=EN-US>Yacc </span>提供的解析器是由带有一个栈的有穷状态自动机组成。解析器自身还有能力读取和记住<span
lang=EN-US>(</span>叫做超前<span lang=EN-US>(lookahead)</span>记号<span lang=EN-US>)</span>下一个输入记号。当前状态总是在栈顶。有穷状态自动机的状态是一个给定的小整数标签<span
lang=EN-US>(label)</span>；最初时，机器是在状态<span lang=EN-US> 0 </span>下，栈只包含状态<span
lang=EN-US> 0</span>，没有读取超前记号。</p>

<p>机器对它只能获得四个动作，叫做移进<span lang=EN-US>(shift)</span>、归约<span lang=EN-US>(reduce)</span>、接受和错误。解析器的移动按如下规则进行<span
lang=EN-US>: </span></p>

<blockquote style='margin-top:5.0pt;margin-bottom:5.0pt'>

<p><span lang=EN-US>1. </span>基于它的当前状态，解析器决定是否需要一个超前记号来决定应当做什么动作；如果需要并且没有读取，则调用<span
lang=EN-US> yylex </span>来获得下一个记号。</p>

<p><span lang=EN-US>2. </span>使用当前状态，和超前记号<span lang=EN-US>(</span>如果需要的话<span
lang=EN-US>)</span>，解析器决定它的下一个状态，并完成它。这可能导致状态压入栈中，或从栈中弹出来，和导致超前记号被处理或保留。 </p>

</blockquote>

<p>移进动作是解析器做的最常见的动作。在做移进动作的时候，这里总是有一个超前记号。例如，在状态<span lang=EN-US> 56 </span>下有这么一个动作<span
lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>shift 34</span></pre>

<p class=MsoNormal>这是说，在状态<span lang=EN-US> 56 </span>下，如果超前字符是<span
lang=EN-US> IF</span>，则当前状态<span lang=EN-US>(56)</span>在栈中被压下去，而状态<span
lang=EN-US> 34 </span>成为当前状态<span lang=EN-US>(</span>在栈顶<span lang=EN-US>)</span>。超前字符被清除。</p>

<p>归 约动作防止栈无限制的增长。在解析器已经见到一个文法的右手端的时候做归约动作是适当的，它准备好宣布它已经见到这个规则的一个实例 <span
lang=EN-US>(instance)</span>，用这个规则的左手端替换它的右手端。有可能需要参考超前记号来决定是否归约，但是通常不需要；实际上，缺省动作<span
lang=EN-US>(</span>表示为<span lang=EN-US>“.”)</span>经 常是一个归约动作。</p>

<p>归约动作与单独的文法规则相关联。文法规则也以小整数给出，这导致了一些混淆。动作 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>reduce 18</span></pre>

<p class=MsoNormal>提及的是文法规则<span lang=EN-US> 18</span>，而动作 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>shift 34</span></pre>

<p class=MsoNormal>提及的是状态<span lang=EN-US> 34</span>。</p>

<p>假定要归约的规则是 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A : x y z ;</span></pre>

<p>归约动作依赖于左手端符号<span lang=EN-US>(symbol)(</span>这里是<span lang=EN-US> A)</span>，和右手端符号的数目<span
lang=EN-US>(</span>这里是<span lang=EN-US> 3)</span>。要归约，首先从栈顶中弹出三个状态<span
lang=EN-US>(</span>一般的，弹出的状态数目等于规则右手端符号的数目<span lang=EN-US>)</span>。在效果上，这些状态识在识别<span
lang=EN-US> x</span>、<span lang=EN-US>y </span>和<span lang=EN-US> z </span>的时候压入栈中的，并不再有任何用处。在弹出这些状态之后，开始处理这个规则之前，分析器处在暴露<span
lang=EN-US>(uncovered)</span>状态下。使用这个暴露状态，和在规则左手端的符号，进行实效上的移进<span lang=EN-US>
A</span>。获得一个新状态，压入栈中，并继续分析。在处理左手端符号和记号的普通移进之间有一个重要的区别，所以这个动作叫做跳转<span
lang=EN-US>(goto)</span>动作。特别是，移进清除超前记号，而跳转不影响它。在任何情况下，暴露状态都包含一个条目比如<span
lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>goto 20</span></pre>

<p class=MsoNormal>导致状态<span lang=EN-US> 20 </span>被压入栈中，并成为当前状态。</p>

<p>在效果上，归约动作在解析器中<span lang=EN-US>“</span>把钟拨回<span lang=EN-US>”</span>，从栈中弹出状态，以此回到首次见到这个规则的右手端的那个状态。解析器接着运转，如同它已经在此时见到了左手端那样。如果这个规则的右手端为空，则不从栈中弹出状态<span
lang=EN-US>: </span>暴露状态实际上就是当前状态。</p>

<p>归约动作在用户提供的动作和值的处置中也是很重要的。在一个规则被归约的时候，在调整栈之前执行这个规则提供的代码。除了持有状态栈之外，还有另一个栈与它并行运行，它持有从词法分析器和这些动作返回的值。在发生移进的时候，把外部变量<span
lang=EN-US> yylval </span>复制到值栈顶上。在从用户代码返回之后，完成归约。在做跳转动作的时候，把外部变量<span
lang=EN-US> yyval </span>复制到到值栈顶上。伪变量<span lang=EN-US> $1</span>、<span
lang=EN-US>$2 </span>等提及的就是这个值栈。</p>

<p>其 他两个解析器动作在概念上非常简单。接受动作指示整个输入已经查看完了并且它与规定相匹配。这个动作只在超前记号是结束标记的时候出现，并指示出解析器已 经成功的完成了它的工作。在另一方面，错误动作表示解析器不能再继续依据规定做解析的状况。已经见到的输入记号，与超前记号一起，不能遵循导致合法输入的
任何东西。解析器报告一个错误，并尝试恢复状态并重新开始解析<span lang=EN-US>: </span>错误修复<span lang=EN-US>(</span>相对于错误检测<span
lang=EN-US>)</span>将在第<span lang=EN-US> 7 </span>节中叙述。 </p>

<p>是给出例子的时候了<span lang=EN-US>! </span>考虑下列规定 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%token<span style='mso-spacerun:yes'>&nbsp; </span>DING<span style='mso-spacerun:yes'>&nbsp; </span>DONG<span style='mso-spacerun:yes'>&nbsp; </span>DELL</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%%</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rhyme<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>sound<span style='mso-spacerun:yes'>&nbsp; </span>place</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>sound<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DING<span style='mso-spacerun:yes'>&nbsp; </span>DONG</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>place<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DELL</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<p>在使用<span lang=EN-US> -v </span>选项调用<span lang=EN-US> Yacc </span>的时候，生成一个叫做<span
lang=EN-US> y.output </span>的文件，它包含对解析器的人类可读的描述。对应于上述文法的<span lang=EN-US>
y.output </span>文件<span lang=EN-US>(</span>去除了结尾处的一些统计<span lang=EN-US>)</span>是<span
lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>state 0</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$accept<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp; </span>_rhyme<span style='mso-spacerun:yes'>&nbsp; </span>$end</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DING<span style='mso-spacerun:yes'>&nbsp; </span>shift 3</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.<span style='mso-spacerun:yes'>&nbsp; </span>error</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>rhyme<span style='mso-spacerun:yes'>&nbsp; </span>goto 1</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>sound<span style='mso-spacerun:yes'>&nbsp; </span>goto 2</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>state 1</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$accept<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>rhyme_$end</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$end<span style='mso-spacerun:yes'>&nbsp; </span>accept</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.<span style='mso-spacerun:yes'>&nbsp; </span>error</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>state 2</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rhyme<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>sound_place</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DELL<span style='mso-spacerun:yes'>&nbsp; </span>shift 5</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.<span style='mso-spacerun:yes'>&nbsp; </span>error</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>place<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>goto 4</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>state 3</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>sound<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>DING_DONG</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DONG<span style='mso-spacerun:yes'>&nbsp; </span>shift 6</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.<span style='mso-spacerun:yes'>&nbsp; </span>error</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>state 4</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rhyme<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>sound<span style='mso-spacerun:yes'>&nbsp; </span>place_<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>(1)</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>reduce<span style='mso-spacerun:yes'>&nbsp; </span>1</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>state 5</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>place<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>DELL_<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>(3)</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>reduce<span style='mso-spacerun:yes'>&nbsp; </span>3</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>state 6</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>sound<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>DING<span style='mso-spacerun:yes'>&nbsp; </span>DONG_<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>(2)</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>.<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>reduce<span style='mso-spacerun:yes'>&nbsp; </span>2</span></pre>

<p class=MsoNormal>注意，除了在每个状态的给出动作之外，在每个状态中还有对正在处理中的解析规则的描述。使用<span lang=EN-US>
_ </span>字符指示在每个规则中见到了什么，和什么仍未出现。假定输入是 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DING<span style='mso-spacerun:yes'>&nbsp; </span>DONG<span style='mso-spacerun:yes'>&nbsp; </span>DELL</span></pre>

<p class=MsoNormal>跟踪解析器在处理这个输入期间的步骤是有教益的。</p>

<p>最初，当前状态是<span lang=EN-US> 0</span>。解析器需要参照输入来在状态<span lang=EN-US> 0 </span>下能获得的动作中做出抉择，所以读入了第一个记号<span
lang=EN-US> DING</span>，它成为超前记号。在状态<span lang=EN-US> 0 </span>下对记号<span
lang=EN-US> DING </span>的动作是<span lang=EN-US>“shift 3”</span>，所以状态<span
lang=EN-US> 3 </span>被压入栈中，超前记号被清除。状态<span lang=EN-US> 3 </span>成为当前状态。读入下一个记号<span
lang=EN-US> DONG</span>，它成为超前记号。在状态<span lang=EN-US> 3 </span>下对记号<span
lang=EN-US> DONG </span>的动作是<span lang=EN-US>“shift 6”</span>所以状态<span
lang=EN-US> 6 </span>被压入栈中，超前记号被清除。栈现在包含<span lang=EN-US> 0</span>、<span
lang=EN-US>3 </span>和<span lang=EN-US> 6</span>。在 状态<span lang=EN-US> 6 </span>下，不用参考超前记号，解析器按规则<span
lang=EN-US> 2 </span>归约。 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>sound<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>DING<span style='mso-spacerun:yes'>&nbsp; </span>DONG</span></pre>

<p class=MsoNormal>这个规则在右手端有两个符号。所以从栈中弹出两个状态<span lang=EN-US> 6 </span>和<span
lang=EN-US> 3</span>，暴露了状态<span lang=EN-US> 0</span>。参照状态<span lang=EN-US> 0 </span>的描述，查找对<span
lang=EN-US> sound </span>的跳转，获得了 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>sound<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>goto 2</span></pre>

<p class=MsoNormal>；所以状态<span lang=EN-US> 2 </span>压入中，成为当前状态。</p>

<p>在状态<span lang=EN-US> 2 </span>下，必须读取下一个记号<span lang=EN-US> DELL</span>。动作是<span
lang=EN-US>“shift 5”</span>，所以状态<span lang=EN-US> 5 </span>被压入栈中，栈中现在有<span
lang=EN-US> 0</span>、<span lang=EN-US>2 </span>和<span lang=EN-US> 5</span>，超前记号被清除。在状态<span
lang=EN-US> 5 </span>下，唯一的动作是按规则<span lang=EN-US> 3 </span>归约。它在右手端有一个符号，所以从栈中弹出一个状态<span
lang=EN-US> 5</span>，暴露了状态<span lang=EN-US> 2</span>。在状态<span lang=EN-US> 2 </span>下对规则<span
lang=EN-US> 3 </span>的左手端<span lang=EN-US> place </span>做跳转到状态<span lang=EN-US>
4</span>。现在栈包含<span lang=EN-US> 0</span>、<span lang=EN-US>2 </span>和<span
lang=EN-US> 4</span>。在状态<span lang=EN-US> 4 </span>下，唯一的动作是按规则<span lang=EN-US>
1 </span>归约。规则<span lang=EN-US> 1 </span>右手端有两个符号，所以从栈中弹出两个状态，再次暴露了状态<span
lang=EN-US> 0</span>。在状态<span lang=EN-US> 0 </span>下，对<span lang=EN-US> rhyme </span>有一个跳转导致分析器进入状态<span
lang=EN-US> 1</span>。在状态<span lang=EN-US> 1 </span>下，读取输入，获得了结束标记，它在<span
lang=EN-US> y.output </span>中用<span lang=EN-US>“$end”</span>来指示。在状态<span
lang=EN-US> 1 </span>下在见到结束标记时的动作是接受，成功的结束了解析。</p>

<p>读者可能急切的想知道在面对不正确的字符串比如<span lang=EN-US> DING DONG DONG</span>、<span
lang=EN-US>DING DONG</span>、<span lang=EN-US>DING DONG DELL DELL </span>等的时候解析器如何工作。在这个和其他简单例子中多花点时间，在更复杂的上下文中出现问题的时候解决起来就快速了。
</p>

<h2><a name=5><span lang=EN-US>5: </span>歧义和冲突</a> </h2>

<p>如果某些输入字符串可以按两种或更多方式来构造，则这组文法是有歧义的。例如，文法规则 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'-'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre>

<p class=MsoNormal>是表达算术表达式的一种自然的方式，把两个其他表达式放在一起并在中间的放一个减号就形成了算术表达式。不幸的是，这个文法规则没有完全的规定构造所有复杂输入的方式。例如，如果输入是
</p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre>

<p class=MsoNormal>规则允许这个输入被构造为 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre>

<p>或者是 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>)</span></pre>

<p class=MsoNormal><span lang=EN-US>(</span>第一个叫左结合<span lang=EN-US>(association)</span>，第二个叫右结合<span
lang=EN-US>)</span>。</p>

<p><span lang=EN-US>Yacc </span>尝试建造解析器的时候检测这种歧义。考虑在给出如下输入的时候解析器所面对的问题是有教益的 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre>

<p class=MsoNormal>当解析器读到第二个<span lang=EN-US> expr </span>的时候，它已经见到的输入是<span
lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre>

<p class=MsoNormal>匹配上述文法规则的右手端。解析器可以通过应用这个规则来归约输入；在应用了这个规则之后，输入被归约成<span
lang=EN-US> expr(</span>规则的左手端<span lang=EN-US>)</span>。解析器可以接着读取输入的最后部分<span
lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre>

<p class=MsoNormal>并再次归约。这种效果是采用了左结合解释。</p>

<p>可供选择的，在解析器见到 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr - expr</span></pre>

<p>它可以延迟应用规则，并继续读取输入直到它见到 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre>

<p class=MsoNormal>它可以接着向最右的三个符号应用规则，把它们归约成<span lang=EN-US> expr </span>并留下 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre>

<p class=MsoNormal>现在这个规则可以再次归约；这种效果是采用了右结合解释。所以，读取了 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre>

<p class=MsoNormal>分析器可以做两种合法的事情，一次移进或一次归约，在它们之间无法抉择，这叫做移进<span lang=EN-US>/</span>归约冲突。也可能发生解析器选择两个合法归约动作的事情；这叫做归约<span
lang=EN-US>/</span>归约冲突。注意永远不会有什么<span lang=EN-US>“</span>移进<span lang=EN-US>/</span>移进<span
lang=EN-US>”</span>冲突。</p>

<p>在有移进<span lang=EN-US>/</span>归约或归约<span lang=EN-US>/</span>归约冲突的时候，<span
lang=EN-US>Yacc </span>仍然生成解析器。它是通过在需要选择地方选择有效步骤之一而完成的。描述在一个给定状况下做如何抉择的规则叫做去歧义规则。</p>

<p><span lang=EN-US>Yacc </span>缺省的调用两个去歧义规则<span lang=EN-US>: </span></p>

<blockquote style='margin-top:5.0pt;margin-bottom:5.0pt'>

<p><span lang=EN-US>1. </span>在移进<span lang=EN-US>/</span>归约冲突中，缺省是做移进。</p>

<p><span lang=EN-US>2. </span>在归约<span lang=EN-US>/</span>归约冲突中，缺省是归约<span
lang=EN-US>(</span>按输入顺序<span lang=EN-US>)</span>更早先的文法规则。 </p>

</blockquote>

<p>规则<span lang=EN-US> 1 </span>暗示了只要有选择就推迟归约、以利于移进。规则<span lang=EN-US> 2 </span>给予用户对解析器在这种情况下的行为的非常粗糙的控制，但是归约<span
lang=EN-US>/</span>归约冲突应当尽可能的避免。</p>

<p>引发冲突的原因可能是输入或逻辑中的错误，也可能因为尽管文法规则是一致的、但要求比<span lang=EN-US> Yacc </span>能构造的更加复杂的解析器。使用在规则内的动作也可能导致冲突，如果必须在解析器可以确定识别了哪个规则之前做这个动作的话。在这些情况下，去歧义规则的应用是不适当的，并导致不正确的解析器。为此，<span
lang=EN-US>Yacc </span>总是报告规则<span lang=EN-US> 1 </span>和规则<span lang=EN-US> 2 </span>解决的移进<span
lang=EN-US>/</span>归约和归约<span lang=EN-US>/</span>归约冲突的数目。</p>

<p>一般的说，只要有可能应用去歧义规则生成正确的解析器，就有可能重写文法规则，使对同样的输入没有冲突。为此，多数以前的解析器生成器认为冲突是致命错误。我们的经验是这种重写是有些不自然的，并生成更慢的解析器；所以<span
lang=EN-US> Yacc </span>即使在有冲突存在情况下还是生成解析器。</p>

<p>去歧义规则的一个例子是，考虑涉及<span lang=EN-US>“if-then-else”</span>构造的编程语言的一个片段<span
lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>stat<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>'('<span style='mso-spacerun:yes'>&nbsp; </span>cond<span style='mso-spacerun:yes'>&nbsp; </span>')'<span style='mso-spacerun:yes'>&nbsp; </span>stat</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>'('<span style='mso-spacerun:yes'>&nbsp; </span>cond<span style='mso-spacerun:yes'>&nbsp; </span>')'<span style='mso-spacerun:yes'>&nbsp; </span>stat<span style='mso-spacerun:yes'>&nbsp; </span>ELSE<span style='mso-spacerun:yes'>&nbsp; </span>stat</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<p>在这些规则中，<span lang=EN-US>IF </span>和<span lang=EN-US> ELSE </span>是记号，<span
lang=EN-US>cond </span>是描述条件<span lang=EN-US>(</span>逻辑<span lang=EN-US>)</span>表达式的非终结符号，而<span
lang=EN-US> stat </span>是描述语句的非终结符号。第一个规则叫做简单<span lang=EN-US>-if </span>规则，第二个叫做<span
lang=EN-US> if-else </span>规则。</p>

<p>这两个规则形成一个歧义构造，因为如下形式的输入 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>C1<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>C2<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>S1<span style='mso-spacerun:yes'>&nbsp; </span>ELSE<span style='mso-spacerun:yes'>&nbsp; </span>S2</span></pre>

<p class=MsoNormal>可以依据两种方式构造<span lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>C1<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>{</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>C2<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>S1</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;</span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ELSE<span style='mso-spacerun:yes'>&nbsp; </span>S2</span></pre>

<p class=MsoNormal>或 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>C1<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>{</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>C2<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>S1</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ELSE<span style='mso-spacerun:yes'>&nbsp; </span>S2</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></pre>

<p class=MsoNormal>第二个解释是多数编程语言对这个构造的解释。每个<span lang=EN-US> ELSE </span>都与最近的前面的<span
lang=EN-US>“</span>没有<span lang=EN-US> ELSE </span>的<span lang=EN-US>” IF </span>相结合。在这个例子中，考虑解析器见到
</p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>C1<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>C2<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>S1</span></pre>

<p class=MsoNormal>并正在查看<span lang=EN-US> ELSE </span>的状况。它可以立即按简单<span
lang=EN-US>-if </span>规则归约得到 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>C1<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>stat</span></pre>

<p class=MsoNormal>并接着读取余下的输入， </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ELSE<span style='mso-spacerun:yes'>&nbsp; </span>S2</span></pre>

<p class=MsoNormal>并按<span lang=EN-US> if-else </span>规则规约 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>C1<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>stat<span style='mso-spacerun:yes'>&nbsp; </span>ELSE<span style='mso-spacerun:yes'>&nbsp; </span>S2</span></pre>

<p class=MsoNormal>。这导致输入的上述组合的第一种情况。</p>

<p>在另一方面，<span lang=EN-US>ELSE </span>可以被移进，读取<span lang=EN-US> S2</span>，并接着把 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>C1<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>C2<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>S1<span style='mso-spacerun:yes'>&nbsp; </span>ELSE<span style='mso-spacerun:yes'>&nbsp; </span>S2</span></pre>

<p class=MsoNormal>的右面部分按<span lang=EN-US> if-else </span>规则规约得到 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF <span style='mso-spacerun:yes'>&nbsp;</span>(<span style='mso-spacerun:yes'>&nbsp; </span>C1<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>stat</span></pre>

<p class=MsoNormal>它可以按简单<span lang=EN-US>-if </span>规则规约。这导致输入的上述组合的第二种情况，这是通常想要的。</p>

<p>一旦解析器可以做两种有效的事情<span lang=EN-US> - </span>就有移进<span lang=EN-US>/</span>规约冲突。应用去歧义规则<span
lang=EN-US> 1 </span>告诉解析器在这种情况下做移进，这导致想要的组合。</p>

<p>这种移进<span lang=EN-US>/</span>归约冲突只发生在特定的当前输入符号<span lang=EN-US> ELSE</span>，和特定的已经见到的输入的时候，比如
</p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>C1<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>C2<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>S1</span></pre>

<p class=MsoNormal>的情况下。一般的说，有很多种冲突，每个都是同一个输入符号和一组以前读入的输入相关联。使用解析器的状态来表现这些以前读入的输入。</p>

<p>通过检查冗余<span lang=EN-US>(-v)</span>选项输出文件<span lang=EN-US> Yacc </span>的冲突消息是最好理解的。例如，对应于上述冲突的输出可能是<span
lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>23: shift/reduce conflict (shift 45, reduce 18) on ELSE</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>state 23</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>stat : IF ( cond ) stat_ (18)</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>stat : IF ( cond ) stat_ELSE stat</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>ELSE shift 45</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>. reduce 18</span></pre>

<p>第一行描述这个冲突，给出状态和输入符号。随后是普通的状态描述，给出在这个状态中活跃的文法规则和解析器动作。回想下划线标记出了文法规则中已经见到的部分。所以在这个例子中，在状态<span
lang=EN-US> 23 </span>中解析器已经见到的输入对应于 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>cond<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>stat</span></pre>

<p class=MsoNormal>并且展示了在此时活跃的两个文法规则。解析器可以做两种可能的事情。如果输入符号是<span lang=EN-US>
ELSE</span>，可能移进到状态<span lang=EN-US> 45</span>。状态<span lang=EN-US> 45 </span>在它的描述中有下面这一行
</p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>stat<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>cond<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>stat<span style='mso-spacerun:yes'>&nbsp; </span>ELSE_stat</span></pre>

<p class=MsoNormal>因为在这个状态下<span lang=EN-US> ELSE </span>已经被移进。回到状态<span
lang=EN-US> 23 </span>中，<span lang=EN-US>“.”</span>描述了一个可供选择的动作，如果输入符号在上述动作中没有明确的提及到则做这个动作；所以，在这种情况下，如果输入符号不是<span
lang=EN-US> ELSE</span>，则解析器将按文法规则<span lang=EN-US> 18 </span>归约<span
lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>stat<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp; </span>IF<span style='mso-spacerun:yes'>&nbsp; </span>'('<span style='mso-spacerun:yes'>&nbsp; </span>cond<span style='mso-spacerun:yes'>&nbsp; </span>')'<span style='mso-spacerun:yes'>&nbsp; </span>stat</span></pre>

<p class=MsoNormal>再次注意紧随<span lang=EN-US>“shift”</span>命令之后的数提及的是其他状态，而紧随<span
lang=EN-US>“</span>归约<span lang=EN-US>”</span>命令的数提及的是文法规则编号。在<span lang=EN-US>
y.output </span>文件中，规则编号在可以被归约的这些规则之后打印。在多数状态中，最有可能存在归约动作的是缺省命令。遇到未期望的移进<span
lang=EN-US>/</span>归约冲突的用户可以查看冗余输出 来决定缺省动作是否合适。在真正的艰苦条件下，用户可能需要知道比这里覆盖的更多的解析器的行为和构造。在这种情况下，可以参考理论文献<span
lang=EN-US>[2, 3, 4]</span>；咨询本地技术领袖也是合适的。 </p>

<h2><a name=6><span lang=EN-US>6: </span>优先级</a> </h2>

<p>在一种常见的情况下，上述解决冲突的规则是不充分的；这发生在分析算术表达式中。算术表达式中多数经常使用的构造可以用操作符优先级概念<span
lang=EN-US> (notion)</span>、连同左或右结合性<span lang=EN-US>(associativity)</span>的信息来自然的描述。使用带有适当的去歧义规则的歧义文法建造的解析器，比使用无歧义
文法构造出的解析器更快速和容易写。基本概念是对想要的所有二元或一元操作符写如下形式的文法规则 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>OP<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre>

<p class=MsoNormal>和 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp; </span>UNARY<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre>

<p class=MsoNormal>。这建立了一个非常有歧义的文法，带有很多解析冲突。作为去歧义规则，用户指定所有操作符的优先级或粘连强度，和二元操作符的结合性。这种信息足够<span
lang=EN-US> Yacc </span>依据这些规则解决解析冲突，并构造实现了想要的优先级和结合性的解析器。</p>

<p>在声明段中把优先级和结合性附加到记号上。在开始于<span lang=EN-US> Yacc </span>关键字<span lang=EN-US>:
%left</span>、<span lang=EN-US>%right </span>或<span lang=EN-US> %nonassoc</span>，并跟随着记号列表的记号定义行中完成这项工作。所有在同一行的记号都被假定有相同的优先级级别和结合性；这些行按递增的优先级或粘连强度次序列出。所以
</p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%left<span style='mso-spacerun:yes'>&nbsp; </span>'+'<span style='mso-spacerun:yes'>&nbsp; </span>'-'</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%left<span style='mso-spacerun:yes'>&nbsp; </span>'*'<span style='mso-spacerun:yes'>&nbsp; </span>'/'</span></pre>

<p class=MsoNormal>描述了四个算术操作符<span lang=EN-US>(</span>算符<span lang=EN-US>)</span>的优先级和结合性。加法和减法是左结合的，并有比星号和斜杠更低的优先级，它们都是左结合的。使用关键字<span
lang=EN-US> %right </span>描述右结合操作符，使用关键字<span lang=EN-US> %nonassoc </span>描述不能与自身结合的操作符，如<span
lang=EN-US> Fortran </span>的<span lang=EN-US> .LT.</span>；所以， </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>A<span style='mso-spacerun:yes'>&nbsp; </span>.LT.<span style='mso-spacerun:yes'>&nbsp; </span>B<span style='mso-spacerun:yes'>&nbsp; </span>.LT.<span style='mso-spacerun:yes'>&nbsp; </span>C</span></pre>

<p class=MsoNormal>在<span lang=EN-US> Fortran </span>中是非法的，这种操作符在<span
lang=EN-US> Yacc </span>中用关键字<span lang=EN-US> %nonassoc </span>描述。作为这些声明的行为的例子，描述
</p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%right<span style='mso-spacerun:yes'>&nbsp; </span>'='</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%left<span style='mso-spacerun:yes'>&nbsp; </span>'+'<span style='mso-spacerun:yes'>&nbsp; </span>'-'</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%left<span style='mso-spacerun:yes'>&nbsp; </span>'*'<span style='mso-spacerun:yes'>&nbsp; </span>'/'</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%%</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'='<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'+'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'-'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'*'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'/'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NAME</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<p class=MsoNormal>可以用来构造输入 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>a<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>b<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>c*d<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>e<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>f*g</span></pre>

<p class=MsoNormal>为如下<span lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>a = ( b = ( ((c*d)-e) - (f*g) ) )</span></pre>

<p class=MsoNormal>在使用这个机制的时候，一元操作符一般必须给出一个优先级。有时一元操作符和二元操作符有相同的符号名字表示，但是有不同的优先级。一个例子是一元和二元<span
lang=EN-US>‘-’</span>；一元减法可以给予同乘法相同的结合强度，甚至更高，而二元减法有比乘法更低的结合强度。关键字<span
lang=EN-US> %prec </span>改变与特定文法规则关联的优先级级别。<span lang=EN-US>%prec </span>直接出现在文法规则主体之后，在动作或结束的分号之前，并跟从一个记号名字或文字。它导致文法规则的优先级变成随后的记号名字或文字的优先级。例如，要使一元减法与乘法有相同的优先级，则规则类似于<span
lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%left<span style='mso-spacerun:yes'>&nbsp; </span>'+'<span style='mso-spacerun:yes'>&nbsp; </span>'-'</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%left<span style='mso-spacerun:yes'>&nbsp; </span>'*'<span style='mso-spacerun:yes'>&nbsp; </span>'/'</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%%</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'+'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'-'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'*'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'/'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'-'<span style='mso-spacerun:yes'>&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%prec<span style='mso-spacerun:yes'>&nbsp; </span>'*'</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NAME</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<p>用<span lang=EN-US> %left</span>、<span lang=EN-US>%right </span>和<span
lang=EN-US> %nonassoc </span>声明的记号不需要但可以用<span lang=EN-US> %token </span>做同样的声明。</p>

<p><span lang=EN-US>Yacc </span>使用优先级和结合性来解决解析冲突；它们引起去歧异规则。形式上，规则工作如下<span
lang=EN-US>: </span></p>

<blockquote style='margin-top:5.0pt;margin-bottom:5.0pt'>

<p><span lang=EN-US>1. </span>为有这种声明的这些记号纪录优先级和结合性。</p>

<p><span lang=EN-US>2. </span>优先级和结合性与每个文法规则相关联；它是这个规则主体的最后的记号或文字的优先级和结合性。如果使用了<span
lang=EN-US> %prec </span>构造，它替代这种缺省。一些文法规则可以没有与之关联的优先级和结合性。</p>

<p><span lang=EN-US>3. </span>在有归约<span lang=EN-US>/</span>归约冲突时候，或者有移进<span
lang=EN-US>/</span>归约冲突并且输入符号或者文法规则之一没有优先级和结合性的时候，则使用在章节开始处给出的两个去歧义规则，并报告冲突。</p>

<p><span lang=EN-US>4. </span>如果有移进<span lang=EN-US>/</span>归约冲突，并且文法规则和输入符号有与之关联的优先级和结合性，则以有利于关联着更高优先级的动作<span
lang=EN-US>(</span>移进或归约<span lang=EN-US>)</span>的方式解决冲突。如果优先级相同，则使用结合性；左结合暗示归约，右结合暗示移进，而无结合暗示错误。
</p>

</blockquote>

<p>用优先级解决的冲突不计数到<span lang=EN-US> Yacc </span>报告的移进<span lang=EN-US>/</span>规约冲突中。这意味着在优先级规定中的错误可以掩饰在输入文法中的错误；对优先级最好持保守的态度，并以本质上的<span
lang=EN-US>“</span>烹调书<span lang=EN-US>”</span>方式使用它们，直到获得了某些经验。在判定解析器实际上是否在做打算让它做的事情时<span
lang=EN-US> y.output </span>文件是非常有用的。 </p>

<h2><a name=7><span lang=EN-US>7: </span>错误处理</a> </h2>

<p>错误处理是一个非常困难的领域，很多问题是语义问题。例如，当找到一个错误的时候，可能必须收回解析树存储，删除或更改符号表条目，和典型的设置开关来避免生成进一步的输出。</p>

<p>在找到一个错误的时候就停止所有处理是很少能被接受；继续扫描输入来找到进一步的语法错误是更加有用的。这导致在一个错误之后使解析器<span
lang=EN-US>“</span>重新启动<span lang=EN-US>”</span>的问题。做这件事的常规的算法涉及到从输入字符串中丢弃一些记号，和尝试调整解析器让输入可以继续。</p>

<p>为 了允许用户在这个过程中做某些控制，<span lang=EN-US>Yacc </span>提供了一个简单但相当一般性的特征。记号名字<span
lang=EN-US>“error”</span>保留给了错误处理。这个名字可以用在文法规则中；在效果上，它提出了预期的错误和修复发生的位 置。解析器弹出它的栈直到进入记号<span
lang=EN-US>“error”</span>合法的一个状态。它接着表现得如同记号<span lang=EN-US>“error”</span>是当前超前记号一样，并进行遇到的动作。超前记号接
着重置为导致这个错误的记号。如果没有指定特殊的错误规则，在检测到错误的时候处理停止。</p>

<p>为了防止连锁<span lang=EN-US>(cascade)</span>的错误消息，解析器在检测到一个错误之后，保持在错误状态下直到成功的读取并移进了三个记号。如果在解析器已经在错误状态下的时候检测到一个错误，则不给出消息，并且安静的删除输入记号。
</p>

<p>作为一个例子，如下形式的规则 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>stat<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>error</span></pre>

<p class=MsoNormal>在效果上，意味着在语法错误的时候，解析器将尝试跳过在其中见到错误的语句。更确切的，解析器将向前扫描，查找可能合法的遵从一个语句的三个
记号，并在其中第一个上开始处理；如果不能充分的辨别出语句的开始，它可能在一个语句的中作出失败的开始，并结束于报告第二个错误，而这里实际上没有错 误。</p>

<p>对这些特殊的错误规则可以使用动作。这些动作可以尝试重新初始化表格，收回符号表空间等。</p>

<p>上面的错误规则是非常一般的，但是难于控制。稍微容易些的是 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>stat<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>error<span style='mso-spacerun:yes'>&nbsp; </span>';'</span></pre>

<p class=MsoNormal>在这里，在有一个错误的时候，解析器尝试跳过这个语句，并跳至下一个<span lang=EN-US>‘;’</span>。在这个错误之后和下一个<span
lang=EN-US>‘;’</span>之前的所有记号都不移进并被丢弃。在见到<span lang=EN-US>‘;’</span>的时候，这个规则将被归约，并进行与之相关联的任何<span
lang=EN-US>“</span>清除<span lang=EN-US>”</span>动作。</p>

<p>错误规则的另一种形式出现在交互式应用中，在这里可能需要允许在一个错误之后重新录入一行。一种可能的错误规则是 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>input<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>error<span style='mso-spacerun:yes'>&nbsp; </span>'\n'<span style='mso-spacerun:yes'>&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp; </span>printf( &quot;Reenter last line: &quot; );<span style='mso-spacerun:yes'>&nbsp; </span>}<span style='mso-spacerun:yes'>&nbsp; </span>input</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$4;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre>

<p class=MsoNormal>这种方式有一个潜在的困难；解析器在承认它已经在错误之后正确的重新同步之前，必须正确的处理三个输入记号。如果重新录入的行在前两个记号中
包含错误，解析器会删除这些讨厌的记号，而不给出消息；这明显的是不可接受的。为此，可以使用一种机制来强制解析器相信错误已经被完全修复了。语句 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>yyerrok ;</span></pre>

<p class=MsoNormal>是一个动作，重置分析器为正常状态。最后的例子可写为更好的 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>input<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>error<span style='mso-spacerun:yes'>&nbsp; </span>'\n'</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>yyerrok;</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>printf( &quot;Reenter last line: &quot; );<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>input</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{ <span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$4;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<p>同上面提及的一样，在<span lang=EN-US>“error”</span>符号之后立即见到的记号是修复了错误的输入记号。有时，这是不恰当的；例如，错误修复动作可能自己承担找到恢复输入的正确位置的工作。在这种情况下，必须清除前面的超前记号。在动作中
</p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>yyclearin ;</span></pre>

<p class=MsoNormal>语句就有这种效果。例如，假定在错误之后的动作要调用用户提供的某种复杂的重新同步例程，尝试把输入前进到下一个有效的语句的开始处。在调用这个例程之后，<span
lang=EN-US>yylex </span>返回的下一个记号大概会是一个合法语句的第一个记号；旧的非法记号必须被清除，这可以用类似下面的规则来做 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>stat<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>error</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>resynch();</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>yyerrok ;</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>yyclearin ;<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<p>无可否认这些机制是粗糙的，但是允许解析器从很多错误中简单而有效的恢复过来；此外，用户可以获得控制权去安排通过程序的其他部分做必需的错误处置动作。 </p>

<h2><a name=8><span lang=EN-US>8: Yacc </span>环境</a> </h2>

<p>在用户向<span lang=EN-US> Yacc </span>输入规定的时候，在多数系统上输出文件是叫做<span lang=EN-US>
y.tab.c </span>的一个<span lang=EN-US> C </span>程序文件<span lang=EN-US>(</span>因为本地文件系统惯例，它的名字在不同安装中可能是不同的<span
lang=EN-US>)</span>。<span lang=EN-US>Yacc </span>生成的函数叫<span lang=EN-US>
yyparse</span>；它是整数值的函数。在调用的时候，它依次重复的调用用户提供的词法分析器<span lang=EN-US> yylex(</span>参见章节<span
lang=EN-US> 3)</span>来获得输入记号。最终，要么是检测到一个错误，在这种情况下<span lang=EN-US>(</span>如果没有错误修复是可能的<span
lang=EN-US>) yyparse </span>返回值<span lang=EN-US> 1</span>，要么词法分析器返回结束标记记号并且解析器接受。在这种情况下，<span
lang=EN-US>yyparse </span>返回值<span lang=EN-US> 0</span>。 </p>

<p>用户必须为解析器提供特定数量的环境来获得一个工作的程序。例如，同每个<span lang=EN-US> C </span>程序一样，必须被定义程序调用的<span
lang=EN-US> main()</span>，它最终调用<span lang=EN-US> yyparse</span>。此外，叫做<span
lang=EN-US> yyerror </span>的一个例程在检测到语法错误的时候打印一个消息。</p>

<p>用户必须以某种形式提供这两个例程。为了减轻使用<span lang=EN-US> Yacc </span>的起初努力，提供了带有缺省版本的<span
lang=EN-US> main </span>和<span lang=EN-US> yyerror </span>的一个库。这个库的名字是依赖系统的；在很多系统上使用到装载器的<span
lang=EN-US> -ly </span>参数来访问这个库。在下面的源代码中展示这些缺省程序作的琐事<span lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>main(){</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return( yyparse() );</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></pre>

<p class=MsoNormal>和 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span># include &lt;stdio.h&gt;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>yyerror(s) char *s; {</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>fprintf( stderr, &quot;%s\n&quot;, s );</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></pre>

<p class=MsoNormal>到<span lang=EN-US> yyerror </span>的参数是包含错误信息的字符串，通常是字符串<span
lang=EN-US>“syntax error”</span>。 一般的应用可能需要更好的消息。通常，程序跟踪输入行数，并与检测到的语法错误一起打印。外部整数变量<span
lang=EN-US> yychar </span>在检测到错误的时候包含超前记号的编号；这对给出更好的诊断有好处。因为<span lang=EN-US>
main </span>程序<span lang=EN-US>(</span>需要读参数等等<span lang=EN-US>)</span>大多数时候是用户提供的。<span
lang=EN-US>Yacc </span>库只在小项目或大点的项目的早期阶段有用。</p>

<p>外部整数变量<span lang=EN-US> yydebug </span>通常设置为<span lang=EN-US> 0</span>。如果设置为非零的值，解析器会输出对它的动作的一个冗余的描述，包括对已经读入哪个输入符号和解析器动作是什么的讨论。依赖于操作系统，可以通过使用调试系统来设置这个变量。
</p>

<h2><a name=9><span lang=EN-US>9: </span>对准备规定的提示</a> </h2>

<p>本节包含对准备有效的、易于变更的和清晰的规定的混杂的提示。单独的小节都或多或少的独立。 </p>

<h4><a name=9.1>输入样式</a> </h4>

<p>提供带有实质动作的规则并保持一个可读的规定文件是困难的。下列样式提示归功于<span lang=EN-US> Brian Kernighan</span>。
</p>

<blockquote style='margin-top:5.0pt;margin-bottom:5.0pt'>

<p><span lang=EN-US>a. </span>为记号名字使用全部的大写字母，为非终结名字使用全部的小写字母。这个规则伴有标题<span
lang=EN-US>“</span>出错时知道是谁的过失<span lang=EN-US>”</span>。</p>

<p><span lang=EN-US>b. </span>把文法规则和动作放在分开的行上。这允许更改任何一个而不会自动的需要改变另一个。</p>

<p><span lang=EN-US>c. </span>把有相同左手端的所有规则放置在一起。只放置左手端一次，并让所有后面的规则以一个竖杠开始。 </p>

<p><span lang=EN-US>d. </span>只在带有给定的左手端的最后一个的规则之后放置一个分号；并把分号放置到单独的行中。这允许容易的添加新规则。</p>

<p><span lang=EN-US>e. </span>用两个<span lang=EN-US> tab </span>停顿缩进规则主体，用三个<span
lang=EN-US> tab </span>停顿缩紧动作主体。 </p>

</blockquote>

<p>在附录<span lang=EN-US> A </span>中的例子用这种样式写成，本文正文中的例子也是这样<span lang=EN-US>(</span>在空间允许的地方<span
lang=EN-US>)</span>。用户必须整理出对这个格式上的问题的自己的意见；但是，中心的问题是使规则在动作代码的沼泽中是明显可见的。 </p>

<h4><a name=9.2>左递归</a> </h4>

<p><span lang=EN-US>Yacc </span>解析器使用的算法鼓励所谓的<span lang=EN-US>“</span>左递归<span
lang=EN-US>”</span>文法规则<span lang=EN-US>: </span>即如下形式的规则 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>name<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>name<span style='mso-spacerun:yes'>&nbsp; </span>rest_of_rule<span style='mso-spacerun:yes'>&nbsp; </span>;</span></pre>

<p class=MsoNormal>在写序列和列表规定的时候经常出现这种规则<span lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>list<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>item</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>list<span style='mso-spacerun:yes'>&nbsp; </span>','<span style='mso-spacerun:yes'>&nbsp; </span>item</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<p class=MsoNormal>和 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>seq<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>item</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>seq<span style='mso-spacerun:yes'>&nbsp; </span>item</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>;</span></pre>

<p class=MsoNormal>在每种情况下，第一个规则只对第一个项目归约，而第二个规则对第二个和所有随后的项目归约。</p>

<p>使用右递归规则，比如 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>seq<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>item</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>item<span style='mso-spacerun:yes'>&nbsp; </span>seq</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<p class=MsoNormal>解析器会更大，项目将从右至左的见到和归约。更严重的是，如果读的是非常长的序列，解析器的内部栈就有溢出的危险。所以，只要合乎情理用户就应当使用左递归。</p>

<p>有零个元素的序列是否有任何意义是值得考虑的，如果有，考虑写带有空规则的序列规定<span lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>seq<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/* empty */</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>seq<span style='mso-spacerun:yes'>&nbsp; </span>item</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<p class=MsoNormal>再一次，第一个规则将总是正好在读第一个项目之前归约一次，接着第二个规则为读到的每个项目归约一次。允许空序列经常导致增强了的一般性。但是，如果要求<span
lang=EN-US> Yacc </span>去决定它见到的是那个空序列就可能发生冲突，此时它还没有见到足够的东西去知晓<span lang=EN-US>!
</span></p>

<h4><a name=9.3>词法搭配</a> </h4>

<p>一些词法决定依赖于上下文。例如，词法分析器通常需要删除空白，但在被引用的字符串中的空白不能删除。声明中的名字可以录入到符号表中，但表达式中的名字不能录入。</p>

<p>处理这种状况的一种方式是建立一个全局标志<span lang=EN-US>(flag)</span>，词法分析器检查它，动作设置它。例如，假设由<span
lang=EN-US> 0 </span>或多个声明、和随后的<span lang=EN-US> 0 </span>或多个语句组成的一个程序。考虑<span
lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%{</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>int dflag;</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>...<span style='mso-spacerun:yes'>&nbsp; </span>other declarations ...</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%%</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>prog<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>decls<span style='mso-spacerun:yes'>&nbsp; </span>stats</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>decls<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/* empty */</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dflag = 1;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>decls<span style='mso-spacerun:yes'>&nbsp; </span>declaration</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>stats<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/* empty */</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dflag = 0;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>stats<span style='mso-spacerun:yes'>&nbsp; </span>statement</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>...<span style='mso-spacerun:yes'>&nbsp; </span>other rules ...</span></pre>

<p class=MsoNormal>标志<span lang=EN-US> dflag </span>在读语句的时候是<span lang=EN-US> 0</span>，在读声明的时候是<span
lang=EN-US> 1</span>，在第一语句中第一个记号除外。 这个记号必须在解析器可以断定声明段落已经结束而语句段落已经开始之前被它见到。在很多情况下，这个单一的记号例外不影响词法扫描。</p>

<p>这种<span lang=EN-US>“</span>后门<span lang=EN-US>”</span>方式可能精细到有害的程度。尽管它提出了做某些困难的事情的方法，除非万不得已，最好用其他方式。</p>

<h4><a name=9.4>保留字</a> </h4>

<p>一些编程语言允许用户使用通常被保留的字如<span lang=EN-US>“if”</span>作为标签或变量名字，假如这种用法不与这些名字在编程语言中法定用法相冲突的话。在<span
lang=EN-US> Yacc </span>的框架中这么做是非常困难的；难于向词法分析器传递信息来告诉它<span lang=EN-US>“‘if’</span>的这个实例是关键字，而那个实例是变量<span
lang=EN-US>”</span>。使用前一小节描述的机制，用户可以做极力的尝试，但这是困难的。</p>

<p>有好几个令这件事情简单些的建议在讨论中。不过在讨论出结果之前，关键字最好被保留；就是说，禁止用作变量名字。总之，偏好如此有着强大的风格上的理由。 </p>

<h2><a name=10><span lang=EN-US>10: </span>高级主题</a> </h2>

<p>本节讨论<span lang=EN-US> Yacc </span>的一些高级特征。 </p>

<h4><a name=10.1>在动作中模拟错误和接受</a> </h4>

<p>解析器的错误和接受动作可以在动作中使用宏<span lang=EN-US> YYACCEPT </span>和<span lang=EN-US>
YYERROR </span>来模拟。<span lang=EN-US>YYACCEPT </span>导致<span lang=EN-US> yyparse
</span>返回值<span lang=EN-US> 0</span>；<span lang=EN-US>YYERROR </span>导致解析器表现得如同当前输入符号有语法错误一样；调用<span
lang=EN-US> yyerror</span>，错误修复就发生。可以使用这些机制来模拟多个结束标记或做上下文相关的语法检查的解析器。 </p>

<h4><a name=10.2>访问外围规则中的值</a> </h4>

<p>动作可以引用当前规则左面的规则的动作返回值。这种机制几乎和普通的动作完全相同，使用跟随着一个数字的美元符号，但是在这种情况下数字可以是<span
lang=EN-US> 0 </span>或负数。考虑 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>sent<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>adj<span style='mso-spacerun:yes'>&nbsp; </span>noun<span style='mso-spacerun:yes'>&nbsp; </span>verb<span style='mso-spacerun:yes'>&nbsp; </span>adj<span style='mso-spacerun:yes'>&nbsp; </span>noun</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp; </span>look at the sentence . . .<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>adj<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>THE<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$ = THE;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>YOUNG<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$ = YOUNG;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>. . .</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>noun<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DOG</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$ = DOG;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CRONE</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if( $0 == YOUNG ){</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>printf( &quot;what?\n&quot; );</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$ = CRONE;</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>. . .</span></pre>

<p class=MsoNormal>在紧随<span lang=EN-US> CRONE </span>的动作中，做了前面移进的记号不是<span
lang=EN-US> YOUNG </span>的检查。明显的，这只有在知晓输入中先于<span lang=EN-US> noun </span>的是什么的时候才是可能的。这里有着不同寻常的无组织特色。然而，有时这种机制能省去大量的麻烦，特别是在要从在其他方面正规的结构中排除掉一些结合的时候。
</p>

<h4><a name=10.3>支持任意的值类型</a> </h4>

<p>缺省的，动作和词法分析器返回的值是整数。<span lang=EN-US>Yacc </span>还支持其他类型的值，包括结构。此外，<span
lang=EN-US>Yacc </span>跟踪类型，并插入正确的联合成员名字，所以结果的解析器将做严格的类型检查。<span lang=EN-US>Yacc
</span>值栈<span lang=EN-US>(</span>参见章节<span lang=EN-US> 4)</span>被声明为各种想要的值类型的联合。用户声明这个联合，并把联合成员名字关联到有值的每个记号和非终结符上。在通过<span
lang=EN-US> $$ </span>或<span lang=EN-US> $n </span>构造引用这个值的时候，<span lang=EN-US>Yacc
</span>将自动的插入正确的联合成员名字，所以不发生多余的转换。此外，类型检查命令比如<span lang=EN-US> Lint[5] </span>对解析器代码的反应将是非常平静的。
</p>

<p>用三种方式来提供这种类型机制。首先，有一种方式定义联合；这必须由用户来做，因为其他程序特别是词法分析器必须知道联合成员名字。其次，有一种方式把联合成员名字关联记号和非终结符上。最后，有一种机制用来描述<span
lang=EN-US> Yacc </span>不能轻易决定其类型的那些少见的值的类型。</p>

<p>要声明联合，用户可在声明段中包含<span lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%union<span style='mso-spacerun:yes'>&nbsp; </span>{</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>body of union ...</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></pre>

<p class=MsoNormal>这声明了<span lang=EN-US> Yacc </span>值栈，并且外部变量<span lang=EN-US>
yylval </span>和<span lang=EN-US> yyval </span>有等于这个联合的类型。如果使用<span lang=EN-US>
-d </span>选项调用<span lang=EN-US> Yacc</span>，则把联合声明复制到<span lang=EN-US> y.tab.h </span>文件中。二者选一的，联合也可以在头文件中声明，使用<span
lang=EN-US> typedef </span>来定义变量<span lang=EN-US> YYSTYPE </span>去表示这个联合。所以，头文件可以有如下定义<span
lang=EN-US>: </span></p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>typedef union {</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>body of union ...</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>} YYSTYPE;</span></pre>

<p class=MsoNormal>头文件必须通过使用<span lang=EN-US> %{ </span>和<span lang=EN-US> %} </span>包含在声明段中。</p>

<p>一旦定义了<span lang=EN-US> YYSTYPE</span>，必须把联合成员名字关联到各种终结和非终结名字上。使用构造 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>&lt; name &gt;</span></pre>

<p class=MsoNormal>来指示一个联合成员名字。如果它跟随着关键字<span lang=EN-US> %token</span>、<span
lang=EN-US>%left</span>、<span lang=EN-US>%right </span>和<span lang=EN-US>
%nonassoc </span>之一，则把联合成员名字关联到列出的记号上。所以写 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>%left<span style='mso-spacerun:yes'>&nbsp; </span>&lt;optype&gt;<span style='mso-spacerun:yes'>&nbsp; </span>'+'<span style='mso-spacerun:yes'>&nbsp; </span>'-'</span></pre>

<p class=MsoNormal>将导致对这两个记号返回值的任何引用都被标签上联合成员名字<span lang=EN-US> optype</span>。使用另一个类似的关键字<span
lang=EN-US> %type </span>把联合成员名字关联到非终结符上。所以，你可以写 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%type<span style='mso-spacerun:yes'>&nbsp; </span>&lt;nodetype&gt;<span style='mso-spacerun:yes'>&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>stat</span></pre>

<p>仍残留着一些个例，在其中这些机制是不充分的。如果在规则内部有一个动作，这个动作返回的值没有先验的类型。类似的，到左端上下文的值的引用<span
lang=EN-US>(</span>比如<span lang=EN-US> $0 - </span>参见前面小节<span lang=EN-US>)</span>没有留给<span
lang=EN-US> Yacc </span>知道这种类型的轻易的方式。在这种情况下，通过在第一个<span lang=EN-US> $ </span>之后紧接着的<span
lang=EN-US> &lt; </span>和<span lang=EN-US> &gt; </span>之间插入联合成员名字，可以这种引用上施加一个类型。这种用法的一个例子是
</p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>rule<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>aaa<span style='mso-spacerun:yes'>&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp; </span>$&lt;intval&gt;$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>3;<span style='mso-spacerun:yes'>&nbsp; </span>} bbb</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>fun( $&lt;intval&gt;2, $&lt;other&gt;0 );<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<p class=MsoNormal>不建议这种语法，但这种情形很少出现。</p>

<p>在附录<span lang=EN-US> C </span>中给出一个样例规定。在这小节中的设施在使用之前是不被触发的<span lang=EN-US>:
</span>特别是，使用<span lang=EN-US> %type </span>就会开启这种机制。在使用它们的时候，有一种非常严格的检查级别。例如，使用<span
lang=EN-US> $n </span>或<span lang=EN-US> $$ </span>来引用没有定义类型的一些东西会被诊断出来。如果这些设施没有被触发，使用<span
lang=EN-US> Yacc </span>值栈来持有<span lang=EN-US> int </span>类型，历史上同样是真的。 </p>

<h2><a name=11><span lang=EN-US>11: </span>致谢</a> </h2>

<p><span lang=EN-US>Yacc </span>在很大程度上归功于用户们有刺激性的捐献，在他们对<span lang=EN-US>“</span>再多一个特征<span
lang=EN-US>”</span>的无尽的探求中，他们驱使我超越我的本意，并经常超越我的能力。他们令人气恼的不情愿 学会用我的方式做事情，经常导致我按他们的方式做事情；多数这种时候，他们是对的。<span
lang=EN-US>B. W. Kernighan</span>、<span lang=EN-US>P. J. Plauger</span>、<span
lang=EN-US>S. I. Feldman</span>、<span lang=EN-US>C. Imagna</span>、<span
lang=EN-US>M. E. Lesk </span>和<span lang=EN-US> A. Snyder </span>在当前的<span
lang=EN-US> Yacc </span>版本中能发现某些他们的想法。<span lang=EN-US>C. B. Haley </span>贡献了错误修复算法。<span
lang=EN-US>D. M. Ritchie</span>、<span lang=EN-US>B. W. Kernighan </span>和<span
lang=EN-US> M. O. Harris </span>帮助我把本文档翻译成了英文。还要特别感谢<span lang=EN-US> Al Aho</span>，因为他把这座山和其它有趣的东西搬到了穆罕默德面前。
</p>

<h2><a name=r>引用</a> </h2>

<p><span lang=EN-US>1. B. W. Kernighan and D. M. Ritchie, The C Programming
Language, Prentice-Hall, Englewood Cliffs, New Jersey, 1978. </span></p>

<p><span lang=EN-US>2. A. V. Aho and S. C. Johnson, &quot;LR Parsing,&quot;
Comp. Surveys, vol. 6, no. 2, pp. 99-124, June 1974. </span></p>

<p><span lang=EN-US>3. A. V. Aho, S. C. Johnson, and J. D. Ullman,
&quot;Deterministic Parsing of Ambiguous Grammars,&quot; Comm. Assoc. Comp.
Mach., vol. 18, no. 8, pp. 441-452, August 1975. </span></p>

<p><span lang=EN-US>4. A. V. Aho and J. D. Ullman, Principles of Compiler
Design, Addison-Wesley, Reading, Mass., 1977. </span></p>

<p><span lang=EN-US>5. S. C. Johnson, &quot;Lint, a C Program Checker,&quot;
Comp. Sci. Tech. Rep. No. 65, 1978 .]. updated version TM 78-1273-3 </span></p>

<p><span lang=EN-US>6. S. C. Johnson, &quot;A Portable Compiler: Theory and
Practice,&quot; Proc. 5th ACM Symp. on Principles of Programming Languages, pp.
97-104, January 1978. </span></p>

<p><span lang=EN-US>7. B. W. Kernighan and L. L. Cherry, &quot;A System for
Typesetting Mathematics,&quot; Comm. Assoc. Comp. Mach., vol. 18, pp. 151-157,
Bell Laboratories, Murray Hill, New Jersey, March 1975 .]. </span></p>

<p><span lang=EN-US>8. M. E. Lesk, &quot;Lex - A Lexical Analyzer
Generator,&quot; Comp. Sci. Tech. Rep. No. 39, Bell Laboratories, Murray Hill,
New Jersey, October 1975 .]. </span></p>

<h2><a name=a>附录<span lang=EN-US> A: </span>简单的例子</a> </h2>

<p>这个例子给出的是对一个小型桌面计算器的完整的<span lang=EN-US> Yacc </span>规定；这个计算器有<span
lang=EN-US> 26 </span>个寄存器，标签为<span lang=EN-US>“a”</span>到<span lang=EN-US>“z”</span>，并接受算术表达式，允许的操作符有<span
lang=EN-US> +</span>、<span lang=EN-US>-</span>、<span lang=EN-US>*</span>、<span
lang=EN-US>/</span>、<span lang=EN-US>%(</span>模操作符<span lang=EN-US>)</span>、<span
lang=EN-US>&amp;(</span>逐位与<span lang=EN-US>)</span>、<span lang=EN-US>|(</span>逐位或<span
lang=EN-US>)</span>和赋值。如果顶层的表达式是个赋值，则不打印这个值；否则打印。同<span lang=EN-US> C </span>语言一样，以<span
lang=EN-US> 0(</span>零<span lang=EN-US>)</span>开始的整数假定为八进制；否则假定为十进制。</p>

<p>作为<span lang=EN-US> Yacc </span>规定的一个例子，这个桌面计算器的任务是展示如何使用优先级和歧义，并演示了简单的错误修复。主要的过度简化是词法分析阶段比多数应用都要简单，并且输出是立即生成的，一行接一行。注意这里以语法规则的方式读取十进制和八进制整数；这项工作最好由词法分析器来完成。
</p>

<pre><span lang=EN-US>%{</span></pre><pre><span lang=EN-US>#<span style='mso-spacerun:yes'>&nbsp; </span>include<span style='mso-spacerun:yes'>&nbsp; </span>&lt;stdio.h&gt;</span></pre><pre><span
lang=EN-US>#<span style='mso-spacerun:yes'>&nbsp; </span>include<span style='mso-spacerun:yes'>&nbsp; </span>&lt;ctype.h&gt;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>int<span style='mso-spacerun:yes'>&nbsp; </span>regs[26];</span></pre><pre><span
lang=EN-US>int<span style='mso-spacerun:yes'>&nbsp; </span>base;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>%}</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>%start<span style='mso-spacerun:yes'>&nbsp; </span>list</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>%token<span style='mso-spacerun:yes'>&nbsp; </span>DIGIT<span style='mso-spacerun:yes'>&nbsp; </span>LETTER</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>%left<span style='mso-spacerun:yes'>&nbsp; </span>'|'</span></pre><pre><span
lang=EN-US>%left<span style='mso-spacerun:yes'>&nbsp; </span>'&amp;'</span></pre><pre><span
lang=EN-US>%left<span style='mso-spacerun:yes'>&nbsp; </span>'+'<span style='mso-spacerun:yes'>&nbsp; </span>'-'</span></pre><pre><span
lang=EN-US>%left<span style='mso-spacerun:yes'>&nbsp; </span>'*'<span style='mso-spacerun:yes'>&nbsp; </span>'/'<span style='mso-spacerun:yes'>&nbsp; </span>'%'</span></pre><pre><span
lang=EN-US>%left<span style='mso-spacerun:yes'>&nbsp; </span>UMINUS<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>supplies<span style='mso-spacerun:yes'>&nbsp; </span>precedence<span style='mso-spacerun:yes'>&nbsp; </span>for<span style='mso-spacerun:yes'>&nbsp; </span>unary<span style='mso-spacerun:yes'>&nbsp; </span>minus<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>%%<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>beginning<span style='mso-spacerun:yes'>&nbsp; </span>of<span style='mso-spacerun:yes'>&nbsp; </span>rules<span style='mso-spacerun:yes'>&nbsp; </span>section<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>list :<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>empty<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>list<span style='mso-spacerun:yes'>&nbsp; </span>stat<span style='mso-spacerun:yes'>&nbsp; </span>'\n'</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>list<span style='mso-spacerun:yes'>&nbsp; </span>error<span style='mso-spacerun:yes'>&nbsp; </span>'\n'</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>yyerrok;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>stat :<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>printf( &quot;%d\n&quot;, $1 );<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>LETTER<span style='mso-spacerun:yes'>&nbsp; </span>'='<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>regs[$1]<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span
lang=EN-US>expr :<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>'('<span style='mso-spacerun:yes'>&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>')'</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$2;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'+'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>= <span style='mso-spacerun:yes'>&nbsp;</span>$1<span style='mso-spacerun:yes'>&nbsp; </span>+<span style='mso-spacerun:yes'>&nbsp; </span>$3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'-'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>$3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'*'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>*<span style='mso-spacerun:yes'>&nbsp; </span>$3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'/'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>/<span style='mso-spacerun:yes'>&nbsp; </span>$3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'%'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;</span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>%<span style='mso-spacerun:yes'>&nbsp; </span>$3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'&amp;'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>&amp;<span style='mso-spacerun:yes'>&nbsp; </span>$3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp; </span>'|'<span style='mso-spacerun:yes'>&nbsp; </span>expr</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp; </span>$3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>'-'<span style='mso-spacerun:yes'>&nbsp; </span>expr<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%prec<span style='mso-spacerun:yes'>&nbsp; </span>UMINUS</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>$2;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>LETTER</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>regs[$1];<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>number</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>number<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>DIGIT</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>$$ = $1;<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>base<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>($1==0)<span style='mso-spacerun:yes'>&nbsp; </span>?<span style='mso-spacerun:yes'>&nbsp; </span>8<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp; </span>10;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>number<span style='mso-spacerun:yes'>&nbsp; </span>DIGIT</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>base * $1<span style='mso-spacerun:yes'>&nbsp; </span>+<span style='mso-spacerun:yes'>&nbsp; </span>$2;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>%%<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>start<span style='mso-spacerun:yes'>&nbsp; </span>of<span style='mso-spacerun:yes'>&nbsp; </span>programs<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>yylex() {<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>lexical<span style='mso-spacerun:yes'>&nbsp; </span>analysis<span style='mso-spacerun:yes'>&nbsp; </span>routine<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>returns<span style='mso-spacerun:yes'>&nbsp; </span>LETTER<span style='mso-spacerun:yes'>&nbsp; </span>for<span style='mso-spacerun:yes'>&nbsp; </span>a<span style='mso-spacerun:yes'>&nbsp; </span>lower<span style='mso-spacerun:yes'>&nbsp; </span>case<span style='mso-spacerun:yes'>&nbsp; </span>letter,<span style='mso-spacerun:yes'>&nbsp; </span>yylval = 0<span style='mso-spacerun:yes'>&nbsp; </span>through<span style='mso-spacerun:yes'>&nbsp; </span>25<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>return<span style='mso-spacerun:yes'>&nbsp; </span>DIGIT<span style='mso-spacerun:yes'>&nbsp; </span>for<span style='mso-spacerun:yes'>&nbsp; </span>a<span style='mso-spacerun:yes'>&nbsp; </span>digit,<span style='mso-spacerun:yes'>&nbsp; </span>yylval = 0<span style='mso-spacerun:yes'>&nbsp; </span>through<span style='mso-spacerun:yes'>&nbsp; </span>9<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>all<span style='mso-spacerun:yes'>&nbsp; </span>other<span style='mso-spacerun:yes'>&nbsp; </span>characters<span style='mso-spacerun:yes'>&nbsp; </span>are<span style='mso-spacerun:yes'>&nbsp; </span>returned<span style='mso-spacerun:yes'>&nbsp; </span>immediately<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>int<span style='mso-spacerun:yes'>&nbsp; </span>c;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>while(<span style='mso-spacerun:yes'>&nbsp; </span>(c=getchar())<span style='mso-spacerun:yes'>&nbsp; </span>==<span style='mso-spacerun:yes'>&nbsp; </span>' '<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>{/*<span style='mso-spacerun:yes'>&nbsp; </span>skip<span style='mso-spacerun:yes'>&nbsp; </span>blanks<span style='mso-spacerun:yes'>&nbsp; </span>*/<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>is<span style='mso-spacerun:yes'>&nbsp; </span>now<span style='mso-spacerun:yes'>&nbsp; </span>nonblank<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>islower(<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>{</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>yylval<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>'a';</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return<span style='mso-spacerun:yes'>&nbsp; </span>(<span style='mso-spacerun:yes'>&nbsp; </span>LETTER <span style='mso-spacerun:yes'>&nbsp;</span>);</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>isdigit(<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>{</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>yylval<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>'0';</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return(<span style='mso-spacerun:yes'>&nbsp; </span>DIGIT<span style='mso-spacerun:yes'>&nbsp; </span>);</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>return(<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>);</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></pre>

<h2><a name=b>附录<span lang=EN-US> B: Yacc </span>输入语法</a></h2>

<p>这个附录用<span lang=EN-US> Yacc </span>规定来描述<span lang=EN-US> Yacc </span>的上下文相关的输入语法。不考虑上下文依赖。作为讽刺，<span
lang=EN-US>Yacc </span>输入规定语言作为<span lang=EN-US> LR(2) </span>文法来规定是最自然的；有粘性的部分出现在规则中见到了标识符，而它紧随在一个动作后面时候。如果这个标识符跟随着一个冒号，则它是下一个规则的开始；否
则它是当前规则的延续，这只发生规则中嵌入了动作的时候。在实现的时候，词法分析器在见到标识符之后做超前查看，并决定下一个记号<span lang=EN-US>(</span>跳过空白、换行、注释
等<span lang=EN-US>)</span>是否是冒号。如果是，它返回记号<span lang=EN-US> C_IDENTIFIER</span>。否则，它返回<span
lang=EN-US> IDENTIFIER</span>。文字<span lang=EN-US>(</span>被引用的字符串<span
lang=EN-US>)</span>也返回为<span lang=EN-US> IDENTIFIER</span>，而决不担当<span
lang=EN-US> C_IDENTIFIER </span>的角色。 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>grammar<span style='mso-spacerun:yes'>&nbsp; </span>for<span style='mso-spacerun:yes'>&nbsp; </span>the <span style='mso-spacerun:yes'>&nbsp;</span>input<span style='mso-spacerun:yes'>&nbsp; </span>to<span style='mso-spacerun:yes'>&nbsp; </span>Yacc<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>basic<span style='mso-spacerun:yes'>&nbsp; </span>entities<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US>%token<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>IDENTIFIER<span style='mso-spacerun:yes'>&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>includes<span style='mso-spacerun:yes'>&nbsp; </span>identifiers<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>and<span style='mso-spacerun:yes'>&nbsp; </span>literals<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US>%token<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>C_IDENTIFIER<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>identifier<span style='mso-spacerun:yes'>&nbsp; </span>(but<span style='mso-spacerun:yes'>&nbsp; </span>not<span style='mso-spacerun:yes'>&nbsp; </span>literal)<span style='mso-spacerun:yes'>&nbsp; </span>followed<span style='mso-spacerun:yes'>&nbsp; </span>by<span style='mso-spacerun:yes'>&nbsp; </span>colon<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>*/</span></pre><pre><span
lang=EN-US>%token<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>NUMBER<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>[0-9]+<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>reserved<span style='mso-spacerun:yes'>&nbsp; </span>words:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>%type<span style='mso-spacerun:yes'>&nbsp; </span>=&gt;<span style='mso-spacerun:yes'>&nbsp; </span>TYPE,<span style='mso-spacerun:yes'>&nbsp; </span>%left<span style='mso-spacerun:yes'>&nbsp; </span>=&gt;<span style='mso-spacerun:yes'>&nbsp; </span>LEFT,<span style='mso-spacerun:yes'>&nbsp; </span>etc.<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>%token<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>LEFT<span style='mso-spacerun:yes'>&nbsp; </span>RIGHT<span style='mso-spacerun:yes'>&nbsp; </span>NONASSOC<span style='mso-spacerun:yes'>&nbsp; </span>TOKEN<span style='mso-spacerun:yes'>&nbsp; </span>PREC<span style='mso-spacerun:yes'>&nbsp; </span>TYPE<span style='mso-spacerun:yes'>&nbsp; </span>START<span style='mso-spacerun:yes'>&nbsp; </span>UNION</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>%token<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>MARK<span style='mso-spacerun:yes'>&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>the<span style='mso-spacerun:yes'>&nbsp; </span>%%<span style='mso-spacerun:yes'>&nbsp; </span>mark<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US>%token<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>LCURL /*<span style='mso-spacerun:yes'>&nbsp; </span>the<span style='mso-spacerun:yes'>&nbsp; </span>%{<span style='mso-spacerun:yes'>&nbsp; </span>mark<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US>%token<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>RCURL /*<span style='mso-spacerun:yes'>&nbsp; </span>the<span style='mso-spacerun:yes'>&nbsp; </span>%}<span style='mso-spacerun:yes'>&nbsp; </span>mark<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>ascii<span style='mso-spacerun:yes'>&nbsp; </span>character<span style='mso-spacerun:yes'>&nbsp; </span>literals<span style='mso-spacerun:yes'>&nbsp; </span>stand<span style='mso-spacerun:yes'>&nbsp; </span>for<span style='mso-spacerun:yes'>&nbsp; </span>themselves<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>%start<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>spec</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>%%</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>spec<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>defs<span style='mso-spacerun:yes'>&nbsp; </span>MARK<span style='mso-spacerun:yes'>&nbsp; </span>rules<span style='mso-spacerun:yes'>&nbsp; </span>tail</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>tail<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>MARK<span style='mso-spacerun:yes'>&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>In<span style='mso-spacerun:yes'>&nbsp; </span>this<span style='mso-spacerun:yes'>&nbsp; </span>action,<span style='mso-spacerun:yes'>&nbsp; </span>eat<span style='mso-spacerun:yes'>&nbsp; </span>up<span style='mso-spacerun:yes'>&nbsp; </span>the<span style='mso-spacerun:yes'>&nbsp; </span>rest<span style='mso-spacerun:yes'>&nbsp; </span>of<span style='mso-spacerun:yes'>&nbsp; </span>the<span style='mso-spacerun:yes'>&nbsp; </span>file<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>empty:<span style='mso-spacerun:yes'>&nbsp; </span>the<span style='mso-spacerun:yes'>&nbsp; </span>second<span style='mso-spacerun:yes'>&nbsp; </span>MARK<span style='mso-spacerun:yes'>&nbsp; </span>is<span style='mso-spacerun:yes'>&nbsp; </span>optional<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>defs<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>empty<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>defs<span style='mso-spacerun:yes'>&nbsp; </span>def</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>def<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>START<span style='mso-spacerun:yes'>&nbsp; </span>IDENTIFIER</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>UNION<span style='mso-spacerun:yes'>&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp; </span>Copy union<span style='mso-spacerun:yes'>&nbsp; </span>definition<span style='mso-spacerun:yes'>&nbsp; </span>to<span style='mso-spacerun:yes'>&nbsp; </span>output<span style='mso-spacerun:yes'>&nbsp; </span>}</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>LCURL<span style='mso-spacerun:yes'>&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp; </span>Copy<span style='mso-spacerun:yes'>&nbsp; </span>C<span style='mso-spacerun:yes'>&nbsp; </span>code<span style='mso-spacerun:yes'>&nbsp; </span>to<span style='mso-spacerun:yes'>&nbsp; </span>output<span style='mso-spacerun:yes'>&nbsp; </span>file<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>}<span style='mso-spacerun:yes'>&nbsp; </span>RCURL</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>ndefs<span style='mso-spacerun:yes'>&nbsp; </span>rword<span style='mso-spacerun:yes'>&nbsp; </span>tag<span style='mso-spacerun:yes'>&nbsp; </span>nlist</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>rword :<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>TOKEN</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>LEFT</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>RIGHT</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>NONASSOC</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>TYPE</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>tag<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>empty:<span style='mso-spacerun:yes'>&nbsp; </span>union<span style='mso-spacerun:yes'>&nbsp; </span>tag<span style='mso-spacerun:yes'>&nbsp; </span>is<span style='mso-spacerun:yes'>&nbsp; </span>optional<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>'&lt;'<span style='mso-spacerun:yes'>&nbsp; </span>IDENTIFIER<span style='mso-spacerun:yes'>&nbsp; </span>'&gt;'</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>nlist :<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;</span>nmno</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>nlist<span style='mso-spacerun:yes'>&nbsp; </span>nmno</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>nlist<span style='mso-spacerun:yes'>&nbsp; </span>','<span style='mso-spacerun:yes'>&nbsp; </span>nmno</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>nmno<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>IDENTIFIER<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>NOTE:<span style='mso-spacerun:yes'>&nbsp; </span>literal<span style='mso-spacerun:yes'>&nbsp; </span>illegal<span style='mso-spacerun:yes'>&nbsp; </span>with<span style='mso-spacerun:yes'>&nbsp; </span>%type<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>IDENTIFIER<span style='mso-spacerun:yes'>&nbsp; </span>NUMBER<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>NOTE:<span style='mso-spacerun:yes'>&nbsp; </span>illegal<span style='mso-spacerun:yes'>&nbsp; </span>with<span style='mso-spacerun:yes'>&nbsp; </span>%type<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>rules<span style='mso-spacerun:yes'>&nbsp; </span>section<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>rules :<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>C_IDENTIFIER<span style='mso-spacerun:yes'>&nbsp; </span>rbody<span style='mso-spacerun:yes'>&nbsp; </span>prec</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>rules<span style='mso-spacerun:yes'>&nbsp; </span>rule</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>rule<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>C_IDENTIFIER<span style='mso-spacerun:yes'>&nbsp; </span>rbody<span style='mso-spacerun:yes'>&nbsp; </span>prec</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>'|'<span style='mso-spacerun:yes'>&nbsp; </span>rbody<span style='mso-spacerun:yes'>&nbsp; </span>prec</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>rbody :<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>empty<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>rbody<span style='mso-spacerun:yes'>&nbsp; </span>IDENTIFIER</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>rbody<span style='mso-spacerun:yes'>&nbsp; </span>act</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>act<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>'{'<span style='mso-spacerun:yes'>&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp; </span>Copy<span style='mso-spacerun:yes'>&nbsp; </span>action,<span style='mso-spacerun:yes'>&nbsp; </span>translate<span style='mso-spacerun:yes'>&nbsp; </span>$$,<span style='mso-spacerun:yes'>&nbsp; </span>etc.<span style='mso-spacerun:yes'>&nbsp; </span>}<span style='mso-spacerun:yes'>&nbsp; </span>'}'</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre><pre><span
lang=EN-US><o:p>&nbsp;</o:p></span></pre><pre><span lang=EN-US>prec<span style='mso-spacerun:yes'>&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>empty<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>PREC<span style='mso-spacerun:yes'>&nbsp; </span>IDENTIFIER</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>PREC<span style='mso-spacerun:yes'>&nbsp; </span>IDENTIFIER<span style='mso-spacerun:yes'>&nbsp; </span>act</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span>prec<span style='mso-spacerun:yes'>&nbsp; </span>';'</span></pre><pre><span
lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></pre>

<h2><a name=c>附录<span lang=EN-US> C: </span>高级的例子 </a></h2>

<p><span style='mso-bookmark:c'>这个附录给出使用在第<span lang=EN-US> 10 </span>节中讨论的高级特征的文法例子。修改附录<span
lang=EN-US> A </span>的桌面计算器的例子来提供做浮点区间算术的桌面计算器。计算器理解浮点常量、算术操作符<span lang=EN-US>
+</span>、<span lang=EN-US>-</span>、<span lang=EN-US>*</span>、<span lang=EN-US>/</span>、一元<span
lang=EN-US> - </span>和<span lang=EN-US> = (</span>赋值<span lang=EN-US>)</span>，并有从<span
lang=EN-US>“a”</span>到<span lang=EN-US>“z”</span>的<span lang=EN-US> 26 </span>个浮点变量。此外，它还理解区间，写为
</span></p>

<pre><span style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>( x , y )</span></span></pre>

<p class=MsoNormal><span style='mso-bookmark:c'>这里的<span lang=EN-US> x </span>小于等于<span
lang=EN-US> y</span>。还可以使用从<span lang=EN-US>“A”</span>到<span lang=EN-US>“Z”</span>的<span
lang=EN-US> 26 </span>个区间值变量。用法类似于附录<span lang=EN-US> A</span>；赋值不返回值，并不打印东西，而表达式打印<span
lang=EN-US>(</span>浮点或区间<span lang=EN-US>)</span>值。</span></p>

<p><span style='mso-bookmark:c'>这个例子探索了<span lang=EN-US> Yacc </span>和<span
lang=EN-US> C </span>的一些有趣的特征。区间表示为由存储为双精度的左右端点值组成的结构。通过使用<span lang=EN-US>
typedef </span>给这个结构一个类型名字<span lang=EN-US> INTERVAL</span>。<span lang=EN-US>Yacc
</span>值栈还可以包含浮点标量和整数<span lang=EN-US>(</span>用做进入持有变量值的数组的索引<span lang=EN-US>)</span>。注意全部这些策略强烈的依赖于能够用<span
lang=EN-US> C </span>语言赋值结构和联合。实际上，很多动作可以同样的调用返回结构的函数。 </span></p>

<p><span style='mso-bookmark:c'>值得注意的还有使用<span lang=EN-US> YYERROR </span>来处理的错误状况<span
lang=EN-US>: </span>除以包含<span lang=EN-US> 0 </span>的区间，和以错误次序表述的区间。在效果上，<span
lang=EN-US>Yacc </span>的错误修复机制是用来丢弃那些讨厌的行的余下部分的。</span></p>

<p><span style='mso-bookmark:c'>除了在值栈上类型的混合，这个文法还展示了有趣的语法运用，跟踪中介表达式的类型<span
lang=EN-US>(</span>就是标量或区间<span lang=EN-US>)</span>。注意如果上下文需要一个区间值，标量可以自动的提升为区间。这在通过<span
lang=EN-US> Yacc </span>运行这个文法的时候导致大量的冲突<span lang=EN-US>: 18 </span>个移进<span
lang=EN-US>/</span>归约和<span lang=EN-US> 26 </span>个归约<span lang=EN-US>/</span>归约冲突。查看两个输入行就能见到这个问题<span
lang=EN-US>: </span></span></p>

<pre><span style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>2.5 + ( 3.5 - 4. )</span></span></pre>

<p class=MsoNormal><span style='mso-bookmark:c'>和 </span></p>

<pre><span style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>2.5 + ( 3.5 , 4. )</span></span></pre>

<p class=MsoNormal><span style='mso-bookmark:c'>注意在第二个例子中<span lang=EN-US> 2.5 </span>要用在一个区间值表达式中，但是这个事实是不被知晓的一直到读了<span
lang=EN-US>“,”</span>；此时，<span lang=EN-US>2.5 </span>已经完成了，而解析器不能回去并改变它的想法。更一般的，可能需要超前查看任意数目的记号来决定是否把一个标量转换成区间。通过对每个二元区间值操作符使
用两个规则来避免这个问题<span lang=EN-US>: </span>在左操作数<span lang=EN-US>(operand)</span>是标量时一个，在左操作数是区间值时一个。在第二种情况下，右操作数必须是一个区间，所以将自动的应用转换。尽管有了这种逃
避，仍有很多情况可以应用也可以不用转换，导致上述冲突。可以通过在规定文件中首先列出生产标量的规则来解决；在这种方式下，在保持标量值表达式的标量值 直到它们必须被强制成为区间的方向上解决冲突。</span></p>

<p><span style='mso-bookmark:c'>处 理多种类型的这种方式是非常有教益的，但不是很一般性的。如果有很多种表达式类型而不是只有两种，需要的规则数目将戏剧性的增长，冲突数目会更有戏剧性。
所以，尽管这个例子是有教益的，在更加正规的编程语言环境中把类型信息保持为值的一部分、而不是作为文法的一部分是更加实用的。</span></p>

<p><span style='mso-bookmark:c'>最后说一下词法分析。唯一不寻常的特征是浮点常量的处置。使用<span lang=EN-US>
C </span>库例程<span lang=EN-US> atof </span>来做从字符串到双精度值的实际转换。如果词法分析器检测到一个错误，它通过返回在文法中是非法的一个记号来作为响应，激发在解析器中的一个语法错误，并接着做错误修复。
</span></p>

<pre><span style='mso-bookmark:c'><span lang=EN-US>%{</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>#<span style='mso-spacerun:yes'>&nbsp; </span>include<span style='mso-spacerun:yes'>&nbsp; </span>&lt;stdio.h&gt;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>#<span style='mso-spacerun:yes'>&nbsp; </span>include<span style='mso-spacerun:yes'>&nbsp; </span>&lt;ctype.h&gt;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>typedef<span style='mso-spacerun:yes'>&nbsp; </span>struct<span style='mso-spacerun:yes'>&nbsp; </span>interval<span style='mso-spacerun:yes'>&nbsp; </span>{</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>double<span style='mso-spacerun:yes'>&nbsp; </span>lo,<span style='mso-spacerun:yes'>&nbsp; </span>hi;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}<span style='mso-spacerun:yes'>&nbsp; </span>INTERVAL;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>INTERVAL<span style='mso-spacerun:yes'>&nbsp; </span>vmul(),<span style='mso-spacerun:yes'>&nbsp; </span>vdiv();</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>double<span style='mso-spacerun:yes'>&nbsp; </span>atof();</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>double<span style='mso-spacerun:yes'>&nbsp; </span>dreg[ 26 ];</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>INTERVAL<span style='mso-spacerun:yes'>&nbsp; </span>vreg[ 26 ];</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>%}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>%start<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>lines</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>%union<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>{</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>int<span style='mso-spacerun:yes'>&nbsp; </span>ival;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>double<span style='mso-spacerun:yes'>&nbsp; </span>dval;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INTERVAL<span style='mso-spacerun:yes'>&nbsp; </span>vval;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>%token<span style='mso-spacerun:yes'>&nbsp; </span>&lt;ival&gt;<span style='mso-spacerun:yes'>&nbsp; </span>DREG<span style='mso-spacerun:yes'>&nbsp; </span>VREG<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>indices<span style='mso-spacerun:yes'>&nbsp; </span>into<span style='mso-spacerun:yes'>&nbsp; </span>dreg,<span style='mso-spacerun:yes'>&nbsp; </span>vreg<span style='mso-spacerun:yes'>&nbsp; </span>arrays<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>%token<span style='mso-spacerun:yes'>&nbsp; </span>&lt;dval&gt;<span style='mso-spacerun:yes'>&nbsp; </span>CONST<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>floating<span style='mso-spacerun:yes'>&nbsp; </span>point<span style='mso-spacerun:yes'>&nbsp; </span>constant<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>%type<span style='mso-spacerun:yes'>&nbsp; </span>&lt;dval&gt;<span style='mso-spacerun:yes'>&nbsp; </span>dexp<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>expression<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>%type<span style='mso-spacerun:yes'>&nbsp; </span>&lt;vval&gt;<span style='mso-spacerun:yes'>&nbsp; </span>vexp<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>interval<span style='mso-spacerun:yes'>&nbsp; </span>expression<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>precedence<span style='mso-spacerun:yes'>&nbsp; </span>information<span style='mso-spacerun:yes'>&nbsp; </span>about<span style='mso-spacerun:yes'>&nbsp; </span>the<span style='mso-spacerun:yes'>&nbsp; </span>operators<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>%left<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>'+'<span style='mso-spacerun:yes'>&nbsp; </span>'-'</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>%left<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>'*'<span style='mso-spacerun:yes'>&nbsp; </span>'/'</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>%left<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>UMINUS<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>precedence<span style='mso-spacerun:yes'>&nbsp; </span>for<span style='mso-spacerun:yes'>&nbsp; </span>unary<span style='mso-spacerun:yes'>&nbsp; </span>minus<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>%%</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>lines<span style='mso-spacerun:yes'>&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>empty<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>lines<span style='mso-spacerun:yes'>&nbsp; </span>line</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>line<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dexp<span style='mso-spacerun:yes'>&nbsp; </span>'\n'</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>printf(<span style='mso-spacerun:yes'>&nbsp; </span>&quot;%15.8f\n&quot;,<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>);<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>vexp<span style='mso-spacerun:yes'>&nbsp; </span>'\n'</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>printf(<span style='mso-spacerun:yes'>&nbsp; </span>&quot;(%15.8f<span style='mso-spacerun:yes'>&nbsp; </span>,<span style='mso-spacerun:yes'>&nbsp; </span>%15.8f<span style='mso-spacerun:yes'>&nbsp; </span>)\n&quot;,<span style='mso-spacerun:yes'>&nbsp; </span>$1.lo,<span style='mso-spacerun:yes'>&nbsp; </span>$1.hi<span style='mso-spacerun:yes'>&nbsp; </span>);<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DREG<span style='mso-spacerun:yes'>&nbsp; </span>'='<span style='mso-spacerun:yes'>&nbsp; </span>dexp<span style='mso-spacerun:yes'>&nbsp; </span>'\n'</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dreg[$1]<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>VREG<span style='mso-spacerun:yes'>&nbsp; </span>'='<span style='mso-spacerun:yes'>&nbsp; </span>vexp<span style='mso-spacerun:yes'>&nbsp; </span>'\n'</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>vreg[$1]<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>error<span style='mso-spacerun:yes'>&nbsp; </span>'\n'</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>yyerrok;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>dexp<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>CONST</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>DREG</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>dreg[$1];<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dexp<span style='mso-spacerun:yes'>&nbsp; </span>'+'<span style='mso-spacerun:yes'>&nbsp; </span>dexp</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>+<span style='mso-spacerun:yes'>&nbsp; </span>$3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dexp<span style='mso-spacerun:yes'>&nbsp; </span>'-'<span style='mso-spacerun:yes'>&nbsp; </span>dexp</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>$3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dexp<span style='mso-spacerun:yes'>&nbsp; </span>'*'<span style='mso-spacerun:yes'>&nbsp; </span>dexp</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>*<span style='mso-spacerun:yes'>&nbsp; </span>$3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dexp<span style='mso-spacerun:yes'>&nbsp; </span>'/'<span style='mso-spacerun:yes'>&nbsp; </span>dexp</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>/<span style='mso-spacerun:yes'>&nbsp; </span>$3;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'-'<span style='mso-spacerun:yes'>&nbsp; </span>dexp<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%prec<span style='mso-spacerun:yes'>&nbsp; </span>UMINUS</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>- $2;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'('<span style='mso-spacerun:yes'>&nbsp; </span>dexp<span style='mso-spacerun:yes'>&nbsp; </span>')'</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;</span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$2;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>vexp<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>:<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dexp</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$.hi<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$$.lo<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'('<span style='mso-spacerun:yes'>&nbsp; </span>dexp<span style='mso-spacerun:yes'>&nbsp; </span>','<span style='mso-spacerun:yes'>&nbsp; </span>dexp<span style='mso-spacerun:yes'>&nbsp; </span>')'</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$.lo<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$2;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$.hi<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$4;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>if(<span style='mso-spacerun:yes'>&nbsp; </span>$$.lo<span style='mso-spacerun:yes'>&nbsp; </span>&gt;<span style='mso-spacerun:yes'>&nbsp; </span>$$.hi<span style='mso-spacerun:yes'>&nbsp; </span>){</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>printf(<span style='mso-spacerun:yes'>&nbsp; </span>&quot;interval<span style='mso-spacerun:yes'>&nbsp; </span>out<span style='mso-spacerun:yes'>&nbsp; </span>of<span style='mso-spacerun:yes'>&nbsp; </span>order\n&quot;<span style='mso-spacerun:yes'>&nbsp; </span>);</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>YYERROR;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>VREG</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>vreg[$1];<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>vexp<span style='mso-spacerun:yes'>&nbsp; </span>'+'<span style='mso-spacerun:yes'>&nbsp; </span>vexp</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$.hi<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1.hi<span style='mso-spacerun:yes'>&nbsp; </span>+<span style='mso-spacerun:yes'>&nbsp; </span>$3.hi;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$.lo<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1.lo<span style='mso-spacerun:yes'>&nbsp; </span>+<span style='mso-spacerun:yes'>&nbsp; </span>$3.lo;<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dexp<span style='mso-spacerun:yes'>&nbsp; </span>'+'<span style='mso-spacerun:yes'>&nbsp; </span>vexp</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;</span>$$.hi<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>+<span style='mso-spacerun:yes'>&nbsp; </span>$3.hi;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$.lo<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>+<span style='mso-spacerun:yes'>&nbsp; </span>$3.lo;<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>vexp<span style='mso-spacerun:yes'>&nbsp; </span>'-'<span style='mso-spacerun:yes'>&nbsp; </span>vexp</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$.hi<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1.hi<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>$3.lo;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$.lo<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1.lo<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>$3.hi;<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;</span>dexp<span style='mso-spacerun:yes'>&nbsp; </span>'-'<span style='mso-spacerun:yes'>&nbsp; </span>vexp</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$.hi<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>$3.lo;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$.lo<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$1<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>$3.hi;<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>vexp<span style='mso-spacerun:yes'>&nbsp; </span>'*'<span style='mso-spacerun:yes'>&nbsp; </span>vexp</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>vmul(<span style='mso-spacerun:yes'>&nbsp; </span>$1.lo,<span style='mso-spacerun:yes'>&nbsp; </span>$1.hi,<span style='mso-spacerun:yes'>&nbsp; </span>$3<span style='mso-spacerun:yes'>&nbsp; </span>);<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dexp<span style='mso-spacerun:yes'>&nbsp; </span>'*'<span style='mso-spacerun:yes'>&nbsp; </span>vexp</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>vmul(<span style='mso-spacerun:yes'>&nbsp; </span>$1,<span style='mso-spacerun:yes'>&nbsp; </span>$1,<span style='mso-spacerun:yes'>&nbsp; </span>$3<span style='mso-spacerun:yes'>&nbsp; </span>);<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>vexp<span style='mso-spacerun:yes'>&nbsp; </span>'/'<span style='mso-spacerun:yes'>&nbsp; </span>vexp</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>dcheck(<span style='mso-spacerun:yes'>&nbsp; </span>$3<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>YYERROR;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>vdiv(<span style='mso-spacerun:yes'>&nbsp; </span>$1.lo,<span style='mso-spacerun:yes'>&nbsp; </span>$1.hi,<span style='mso-spacerun:yes'>&nbsp; </span>$3<span style='mso-spacerun:yes'>&nbsp; </span>);<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;&nbsp;</span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>dexp<span style='mso-spacerun:yes'>&nbsp; </span>'/'<span style='mso-spacerun:yes'>&nbsp; </span>vexp</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>dcheck(<span style='mso-spacerun:yes'>&nbsp; </span>$3<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>YYERROR;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>vdiv(<span style='mso-spacerun:yes'>&nbsp; </span>$1,<span style='mso-spacerun:yes'>&nbsp; </span>$1,<span style='mso-spacerun:yes'>&nbsp; </span>$3<span style='mso-spacerun:yes'>&nbsp; </span>);<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'-'<span style='mso-spacerun:yes'>&nbsp; </span>vexp<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>%prec<span style='mso-spacerun:yes'>&nbsp; </span>UMINUS</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$.hi<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>-$2.lo;<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>$$.lo<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>-$2.hi;<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>|<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>'('<span style='mso-spacerun:yes'>&nbsp; </span>vexp<span style='mso-spacerun:yes'>&nbsp; </span>')'</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>$$<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>$2;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>%%</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>#<span style='mso-spacerun:yes'>&nbsp; </span>define<span style='mso-spacerun:yes'>&nbsp; </span>BSZ<span style='mso-spacerun:yes'>&nbsp; </span>50<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>buffer<span style='mso-spacerun:yes'>&nbsp; </span>size<span style='mso-spacerun:yes'>&nbsp; </span>for<span style='mso-spacerun:yes'>&nbsp; </span>floating<span style='mso-spacerun:yes'>&nbsp; </span>point<span style='mso-spacerun:yes'>&nbsp; </span>numbers<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>lexical<span style='mso-spacerun:yes'>&nbsp; </span>analysis<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>yylex(){</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>register<span style='mso-spacerun:yes'>&nbsp; </span>c;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>while(<span style='mso-spacerun:yes'>&nbsp; </span>(c=getchar())<span style='mso-spacerun:yes'>&nbsp; </span>==<span style='mso-spacerun:yes'>&nbsp; </span>' '<span style='mso-spacerun:yes'>&nbsp; </span>){<span style='mso-spacerun:yes'>&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>skip<span style='mso-spacerun:yes'>&nbsp; </span>over<span style='mso-spacerun:yes'>&nbsp; </span>blanks<span style='mso-spacerun:yes'>&nbsp; </span>*/<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>isupper(<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>){</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>yylval.ival<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>'A';</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return(<span style='mso-spacerun:yes'>&nbsp; </span>VREG<span style='mso-spacerun:yes'>&nbsp; </span>);</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>islower(<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>){</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>yylval.ival<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>-<span style='mso-spacerun:yes'>&nbsp; </span>'a';</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return(<span style='mso-spacerun:yes'>&nbsp; </span>DREG<span style='mso-spacerun:yes'>&nbsp; </span>);</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>isdigit(<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>||<span style='mso-spacerun:yes'>&nbsp; </span>c=='.'<span style='mso-spacerun:yes'>&nbsp; </span>){</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>gobble<span style='mso-spacerun:yes'>&nbsp; </span>up<span style='mso-spacerun:yes'>&nbsp; </span>digits,<span style='mso-spacerun:yes'>&nbsp; </span>points,<span style='mso-spacerun:yes'>&nbsp; </span>exponents<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>char<span style='mso-spacerun:yes'>&nbsp; </span>buf[BSZ+1],<span style='mso-spacerun:yes'>&nbsp; </span>*cp<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>buf;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>int<span style='mso-spacerun:yes'>&nbsp; </span>dot<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>0,<span style='mso-spacerun:yes'>&nbsp; </span>exp<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>0;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>for(<span style='mso-spacerun:yes'>&nbsp; </span>;<span style='mso-spacerun:yes'>&nbsp; </span>(cp-buf)&lt;BSZ<span style='mso-spacerun:yes'>&nbsp; </span>;<span style='mso-spacerun:yes'>&nbsp; </span>++cp,c=getchar()<span style='mso-spacerun:yes'>&nbsp; </span>){</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*cp<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>c;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>isdigit(<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>continue;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>==<span style='mso-spacerun:yes'>&nbsp; </span>'.'<span style='mso-spacerun:yes'>&nbsp; </span>){</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style='mso-spacerun:yes'>&nbsp;</span>if(<span style='mso-spacerun:yes'>&nbsp; </span>dot++<span style='mso-spacerun:yes'>&nbsp; </span>||<span style='mso-spacerun:yes'>&nbsp; </span>exp<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>return(<span style='mso-spacerun:yes'>&nbsp; </span>'.'<span style='mso-spacerun:yes'>&nbsp; </span>);<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>will<span style='mso-spacerun:yes'>&nbsp; </span>cause<span style='mso-spacerun:yes'>&nbsp; </span>syntax<span style='mso-spacerun:yes'>&nbsp; </span>error<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>continue;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>==<span style='mso-spacerun:yes'>&nbsp; </span>'e'<span style='mso-spacerun:yes'>&nbsp; </span>){</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>exp++<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>return( <span style='mso-spacerun:yes'>&nbsp;</span>'e'<span style='mso-spacerun:yes'>&nbsp; </span>);<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>will<span style='mso-spacerun:yes'>&nbsp; </span>cause<span style='mso-spacerun:yes'>&nbsp; </span>syntax<span style='mso-spacerun:yes'>&nbsp; </span>error<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>continue;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>end<span style='mso-spacerun:yes'>&nbsp; </span>of<span style='mso-spacerun:yes'>&nbsp; </span>number<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>break;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>*cp<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>'\0';</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>(cp-buf)<span style='mso-spacerun:yes'>&nbsp; </span>&gt;=<span style='mso-spacerun:yes'>&nbsp; </span>BSZ<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>printf(<span style='mso-spacerun:yes'>&nbsp; </span>&quot;constant<span style='mso-spacerun:yes'>&nbsp; </span>too<span style='mso-spacerun:yes'>&nbsp; </span>long:<span style='mso-spacerun:yes'>&nbsp; </span>truncated\n&quot;<span style='mso-spacerun:yes'>&nbsp; </span>);</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else<span style='mso-spacerun:yes'>&nbsp; </span>ungetc(<span style='mso-spacerun:yes'>&nbsp; </span>c,<span style='mso-spacerun:yes'>&nbsp; </span>stdin<span style='mso-spacerun:yes'>&nbsp; </span>);<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>push<span style='mso-spacerun:yes'>&nbsp; </span>back<span style='mso-spacerun:yes'>&nbsp; </span>last<span style='mso-spacerun:yes'>&nbsp; </span>char<span style='mso-spacerun:yes'>&nbsp; </span>read<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>yylval.dval<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>atof(<span style='mso-spacerun:yes'>&nbsp; </span>buf<span style='mso-spacerun:yes'>&nbsp; </span>);</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return(<span style='mso-spacerun:yes'>&nbsp; </span>CONST<span style='mso-spacerun:yes'>&nbsp; </span>);</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return(<span style='mso-spacerun:yes'>&nbsp; </span>c<span style='mso-spacerun:yes'>&nbsp; </span>);</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>INTERVAL<span style='mso-spacerun:yes'>&nbsp; </span>hilo(<span style='mso-spacerun:yes'>&nbsp; </span>a,<span style='mso-spacerun:yes'>&nbsp; </span>b,<span style='mso-spacerun:yes'>&nbsp; </span>c,<span style='mso-spacerun:yes'>&nbsp; </span>d<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>double<span style='mso-spacerun:yes'>&nbsp; </span>a,<span style='mso-spacerun:yes'>&nbsp; </span>b,<span style='mso-spacerun:yes'>&nbsp; </span>c,<span style='mso-spacerun:yes'>&nbsp; </span>d;<span style='mso-spacerun:yes'>&nbsp; </span>{</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>returns<span style='mso-spacerun:yes'>&nbsp; </span>the<span style='mso-spacerun:yes'>&nbsp; </span>smallest<span style='mso-spacerun:yes'>&nbsp; </span>interval<span style='mso-spacerun:yes'>&nbsp; </span>containing<span style='mso-spacerun:yes'>&nbsp; </span>a,<span style='mso-spacerun:yes'>&nbsp; </span>b,<span style='mso-spacerun:yes'>&nbsp; </span>c,<span style='mso-spacerun:yes'>&nbsp; </span>and<span style='mso-spacerun:yes'>&nbsp; </span>d<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>/*<span style='mso-spacerun:yes'>&nbsp; </span>used<span style='mso-spacerun:yes'>&nbsp; </span>by<span style='mso-spacerun:yes'>&nbsp; </span>*,<span style='mso-spacerun:yes'>&nbsp; </span>/<span style='mso-spacerun:yes'>&nbsp; </span>routines<span style='mso-spacerun:yes'>&nbsp; </span>*/</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>INTERVAL<span style='mso-spacerun:yes'>&nbsp; </span>v;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>a&gt;b<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp; </span>v.hi<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>a;<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>v.lo<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>b;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else<span style='mso-spacerun:yes'>&nbsp; </span>{<span style='mso-spacerun:yes'>&nbsp; </span>v.hi<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>b;<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>v.lo<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>a;<span style='mso-spacerun:yes'>&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>c&gt;d<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>{</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>c&gt;v.hi<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>v.hi<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>c;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>d&lt;v.lo<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>v.lo<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>d;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>else<span style='mso-spacerun:yes'>&nbsp; </span>{</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>d&gt;v.hi<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>v.hi<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>d;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>c&lt;v.lo<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>v.lo<span style='mso-spacerun:yes'>&nbsp; </span>=<span style='mso-spacerun:yes'>&nbsp; </span>c;</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return(<span style='mso-spacerun:yes'>&nbsp; </span>v<span style='mso-spacerun:yes'>&nbsp; </span>);</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>INTERVAL<span style='mso-spacerun:yes'>&nbsp; </span>vmul(<span style='mso-spacerun:yes'>&nbsp; </span>a,<span style='mso-spacerun:yes'>&nbsp; </span>b,<span style='mso-spacerun:yes'>&nbsp; </span>v<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>double<span style='mso-spacerun:yes'>&nbsp; </span>a,<span style='mso-spacerun:yes'>&nbsp; </span>b;<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>INTERVAL<span style='mso-spacerun:yes'>&nbsp; </span>v;<span style='mso-spacerun:yes'>&nbsp; </span>{</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return(<span style='mso-spacerun:yes'>&nbsp; </span>hilo(<span style='mso-spacerun:yes'>&nbsp; </span>a*v.hi,<span style='mso-spacerun:yes'>&nbsp; </span>a*v.lo,<span style='mso-spacerun:yes'>&nbsp; </span>b*v.hi,<span style='mso-spacerun:yes'>&nbsp; </span>b*v.lo<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>);</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>dcheck(<span style='mso-spacerun:yes'>&nbsp; </span>v<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>INTERVAL<span style='mso-spacerun:yes'>&nbsp; </span>v;<span style='mso-spacerun:yes'>&nbsp; </span>{</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>if(<span style='mso-spacerun:yes'>&nbsp; </span>v.hi<span style='mso-spacerun:yes'>&nbsp; </span>&gt;=<span style='mso-spacerun:yes'>&nbsp; </span>0.<span style='mso-spacerun:yes'>&nbsp; </span>&amp;&amp;<span style='mso-spacerun:yes'>&nbsp; </span>v.lo<span style='mso-spacerun:yes'>&nbsp; </span>&lt;=<span style='mso-spacerun:yes'>&nbsp; </span>0.<span style='mso-spacerun:yes'>&nbsp; </span>){</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>printf(<span style='mso-spacerun:yes'>&nbsp; </span>&quot;divisor<span style='mso-spacerun:yes'>&nbsp; </span>interval<span style='mso-spacerun:yes'>&nbsp; </span>contains<span style='mso-spacerun:yes'>&nbsp; </span>0.\n&quot;<span style='mso-spacerun:yes'>&nbsp; </span>);</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return(<span style='mso-spacerun:yes'>&nbsp; </span>1<span style='mso-spacerun:yes'>&nbsp; </span>);</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return(<span style='mso-spacerun:yes'>&nbsp; </span>0<span style='mso-spacerun:yes'>&nbsp; </span>);</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><o:p>&nbsp;</o:p></span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US>INTERVAL<span style='mso-spacerun:yes'>&nbsp; </span>vdiv(<span style='mso-spacerun:yes'>&nbsp; </span>a,<span style='mso-spacerun:yes'>&nbsp; </span>b,<span style='mso-spacerun:yes'>&nbsp; </span>v<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>double<span style='mso-spacerun:yes'>&nbsp; </span>a,<span style='mso-spacerun:yes'>&nbsp; </span>b;<span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp; </span>INTERVAL<span style='mso-spacerun:yes'>&nbsp; </span>v;<span style='mso-spacerun:yes'>&nbsp; </span>{</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>return(<span style='mso-spacerun:yes'>&nbsp; </span>hilo(<span style='mso-spacerun:yes'>&nbsp; </span>a/v.hi,<span style='mso-spacerun:yes'>&nbsp; </span>a/v.lo,<span style='mso-spacerun:yes'>&nbsp; </span>b/v.hi,<span style='mso-spacerun:yes'>&nbsp; </span>b/v.lo<span style='mso-spacerun:yes'>&nbsp; </span>)<span style='mso-spacerun:yes'>&nbsp; </span>);</span></span></pre><pre><span
style='mso-bookmark:c'><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>}</span></span></pre>

<h2><span style='mso-bookmark:c'>附录</span><a name=d><span lang=EN-US> D: </span>支持但不鼓励的旧特征</a></h2>

<p>本附录涉及为历史连贯性而支持的同义字和特征，但处于各种原因不鼓励使用。 </p>

<blockquote style='margin-top:5.0pt;margin-bottom:5.0pt'>

<p><span lang=EN-US>1. </span>文字也可以用双引号<span lang=EN-US>“&quot;”</span>定界。</p>

<p><span lang=EN-US>2. </span>文字也可以多于一个字符长。如果所有字符都是字母、数字、或 <span lang=EN-US>_</span>，则定义文字的类型编号，如同文字没有包围它的引号一样。否则，难于找到这种文字的值。</p>

<p>多字符文字的使用误导了不熟悉<span lang=EN-US> Yacc </span>的人，因为它暗示了<span lang=EN-US> Yacc </span>正在做实际上词法分析器做的工作。</p>

<p><span lang=EN-US>3. </span>在<span lang=EN-US> % </span>合法的多数位置，反斜杠<span
lang=EN-US>“\”</span>也可以用。特别是，<span lang=EN-US>\\ </span>同于<span lang=EN-US> %%</span>，<span
lang=EN-US>\left </span>同于<span lang=EN-US> %left </span>等等。</p>

<p><span lang=EN-US>4. </span>还有一些其他的同义字<span lang=EN-US>: </span></p>

<blockquote style='margin-top:5.0pt;margin-bottom:5.0pt'>

<p><span lang=EN-US>%&lt; </span>同于<span lang=EN-US> %left<br>
%&gt; </span>同于<span lang=EN-US> %right<br>
%binary </span>和<span lang=EN-US> %2 </span>同于<span lang=EN-US> %nonassoc<br>
%0 </span>和<span lang=EN-US> %term </span>同于<span lang=EN-US> %token<br>
%= </span>同于<span lang=EN-US> %prec</span></p>

</blockquote>

<p><span lang=EN-US>5. </span>动作也可以有如下形式 </p>

<pre><span lang=EN-US><span style='mso-spacerun:yes'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>={ . . . }</span></pre>

<p class=MsoNormal>并且如果动作是一个单一的<span lang=EN-US> C </span>语句则花括号也可以去除掉。</p>

<p><span lang=EN-US>6. </span>在<span lang=EN-US> %{ </span>和<span lang=EN-US>
%} </span>之间的<span lang=EN-US> C </span>代码惯常被允许在规则段的头部出现，同在声明段中一样。 </p>

</blockquote>

<p class=MsoNormal><span lang=EN-US><o:p>&nbsp;</o:p></span></p>

</div>

</body>

</html>
